<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>pagingtable Widget Unit Test</title>
</head>
<body>
  <div class="container well">
	<form class="find_doc">
		<input type="text" class="" name="doc_id"/>
		<input type="text" class="" name="org"/>
		<button class="btn btn-primary" ><i class="icon-search icon-white"></i> Submit</button>
	</form>
    <div id="pagingtable-test"></div>
  </div>
 </body>
<script src="/steal/steal.js" ></script>
<script type='text/javascript'>
	steal(
		'jquery/dom/route',
		'docview/ui/pagingtable'
		).then(function($) {
			$('#pagingtable-test').docview_ui_pagingtable({ 
				columns : [
					{"id" : "doc_id", text: 'Doc Id',width:'100px' },
					{"id" : "org"	, text: 'ORG'},
					{"id" :  null	, text: 'More',tmpl:'btn_detial' }
				]
		//	url:'/documents/test',
		//	data:{},
		//	form:'.find_doc'	
		});
		var controller = $('#pagingtable-test').controller();

		$(".find_doc").submit(function(ev){
			ev.preventDefault();
			var doc_id = $('input[name=doc_id]').val();
			var org = $('input[name=org]').val();
			var data = { 'doc_id':doc_id,'org':org };
		
			controller.reload({
				url:'/documents/test',
				data:data,
				type:'get'
			});
		});
		$('.btn-edit').live('click',function(ev){
			var row = controller.getRowFrom(this);
			var tr = row.element;
			var model = row.model;
			tr.after($.View('detial.ejs',model));
			tr.hide();
			var detial = tr.next();
		
			detial.find('.btn-cancel').click(function(){
				tr.show('slow');
				detial.remove();		
			});
		});
	}); 	 
 </script>
</html>

