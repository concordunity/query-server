/*
 *
 * Wijmo Library 2.0.3
 * http://wijmo.com/
 *
 * Copyright(c) ComponentOne, LLC.  All rights reserved.
 * 
 * Dual licensed under the Wijmo Commercial or GNU GPL Version 3 licenses.
 * licensing@wijmo.com
 * http://wijmo.com/license
 *
 *
 **/
(function(a){"use strict";var d=alert,n=window,tc=document,f=parseInt,zd,vd,rd,c,I,wd=[],J=null,rc=true,U=true,k=0,A=[],j=null,Xb=null,B="wijeditor-",D="setButtonDisabled",Cb="setButtonsDisabled",u="setButtonChecked",Qc="setButtonsChecked",yd="form",Wc="imagebutton",jd="textarea",sd="button",pd="textbox",md="list",hd="passwordfield",Rc="dropdownlist",Vc="hiddenfield",ud="radio",fd="checkbox",Hb="insertcol",ac="insertrow",Tb="insertcell",cc="splitcell",M="mergecell",Ib="deletecol",bc="deleterow",Vb="deletecell",ab="justifyleft",V="justifycenter",W="justifyright",Z="justifyfull",ld="borders",S="insertorderedlist",R="insertunorderedlist",nd="outdent",td="indent",Yb="backcolor",Zb="fontcolor",mb="bold",gb="italic",jb="strikethrough",bb="underline",x="subscript",v="superscript",fc="template",Jb="removeformat",Xc="insertbreak",Gc="insertparagraph",Cc="insertprintpagebreak",gd="inserthorizontalrule",mc="tablebutton",Ob="inserttable",dd="edittable",Sb="wysiwyg",dc="split",Wb="code",N="wordwrap",Zc="fullscreen",E="undo",H="redo",od="preview",hc="cleanup",sc="cut",nc="copy",lc="paste",ed="selectall",kc="media",Pb="specialchar",xd="datetime",oc="find",ic="inspect",qc="save",id="spelling",Gb="imagebrowser",pc="link",db="xx-small",eb="x-small",lb="small",ib="medium",kb="large",hb="x-large",cb="xx-large",t="fontname",y="fontsize",Yc="blockquote",Ub="insertcode",b="wijmo-wijribbon",Ec=b+"-bigbutton",ob=b+"-dropdownbutton",ce=b+"-splitbutton",mf=b+"-list",of=b+"-save",Ye=b+"-save16",pf=b+"-undo",nf=b+"-redo",Qe=b+"-preview",Me=b+"-cleanup",xf=b+"-cut",hf=b+"-copy",df=b+"-paste",ve=b+"-selectall",Ke=b+"-bgcolor",bf=b+"-color",gf=b+"-bold",We=b+"-italic",ye=b+"-underline",Ze=b+"-strike",yf=b+"-sub",zf=b+"-sup",Fe=b+"-template",Rd=b+"-removeformat",ae=b+"-justifyleft",Kd=b+"-justifycenter",Qd=b+"-justifyright",Zd=b+"-justifyfull",Le=b+"-borders",ue=b+"-orderlist",de=b+"-unorderlist",Pe=b+"-outdent",Ve=b+"-indent",Ne=b+"-inspect",jf=b+"-find",Uc=b+"-table",zc=b+"-inserttable",Fc=b+"-edittable",re=b+"-insertcol",se=b+"-insertrow",je=b+"-insertcell",we=b+"-splitcell",te=b+"-mergecell",pe=b+"-deletecol",qe=b+"-deleterow",ge=b+"-deletecell",Yd=b+"-insertbreak",Ed=b+"-insertparagraph",Ad=b+"-insertprintpagebreak",De=b+"-inserthr",kf=b+"-form",Ge=b+"-textarea",Re=b+"-textbox",Ee=b+"-password",Wd=b+"-hiddenfield",Xd=b+"-imagebutton",Ue=b+"-button",Oe=b+"-listbox",Od=b+"-dropdownlist",ef=b+"-radio",Be=b+"-checkbox",lf=b+"-link",Xe=b+"-link16",Pd=b+"-imagebrowser",cf=b+"-media",be=b+"-specialchar",Ce=b+"-datetime",fe=b+"-blockquote",ke=b+"-insertcode",Tc=b+"-modes",he=b+"-designview",le=b+"-sourceview",xe=b+"-splitview",He=b+"-wordwrap",ie=b+"-fullscreen",e="wijmo-wijeditor",oe=e+"-container",Oc=e+"-header",Lc=e+"-content",Nc=e+"-footer",wc=e+"-pathselector",Ac=e+"-fullscreen",nb=e+"-dialog",Ef=nb+"-hr",G=nb+"-buttons",o=nb+"-button",h=nb+"-text",m=e+"-imagedlg",Ie=m+"-content",Se=m+"-fields",Kb=m+"-imagefield",ff=m+"-imagelist",Je=m+"-preview",Y=m+"-imagesrc",ad=m+"-imagealt",Lb=m+"-imagewidth",Db=m+"-imageheight",bd=m+"-css",ub=m+"-hideimagelist",g=e+"-templatedlg",Bf=g+"-toplabels",tf=g+"-topleftlabel",vf=g+"-toprightlabel",rf=g+"-content",Cf=g+"-templatelist",sf=g+"-preview",uf=g+"-templateinfo",Nb=g+"-nameinfo",Rb=g+"-descriptioninfo",Af=g+"-fields",L=g+"-name",T=g+"-description",qf=g+"-buttons",cd=g+"-delete",kd=g+"-save",z=e+"-linkdlg",K=z+"-address",Dc=z+"-linktype",Ab=z+"-anchor",Mb=z+"-text",Q=z+"-target",Qb=z+"-css",qd=e+"-codedlg",Kc=qd+"-source",Nd=qd+"-sourcelabel",s=e+"-taginsdlg",ne=s+"-caption",ee=s+"-taglabel",Bc=s+"-tagtext",Hd=s+"-filterempty",me=s+"-attribs",P=s+"-attriblist",tb=s+"-innerhtml",Fb=s+"-css",gc=e+"-colordlg",xb=gc+"-picker",C=gc+"-color",q=e+"-tabledlg",Eb=q+"-rows",vb=q+"-columns",Bb=q+"-width",zb=q+"-height",yb=q+"-border",rb=q+"-cellpadding",sb=q+"-cellspacing",wb=q+"-csstext",F=q+"-bgcolor",p=e+"-previewdlg",Vd=p+"-caption",pb=p+"-navigator",Jc=p+"-prev",Ic=p+"-next",xc=p+"-printall",yc=p+"-printone",Pc=p+"-ok",uc=p+"-printdocument",Dd=p+"-previewiframe",X=e+"-cleanupdlg",Ud=X+"-caption",Md=X+"-document",Td=X+"-actions",jc=e+"-finddlg",af=jc+"-find",Ae=jc+"-replace",O=e+"-mediadlg",Te=O+"-type",Sc=O+"-src",Mc=O+"-width",Hc=O+"-height",r=e+"-specialchardlg",Ld=r+"-chars",Fd=r+"-preview",vc=r+"-content",Sd=r+"-list",qb=r+"_label",Bd=r+"-punctuation",Gd=r+"-symbols",Cd=r+"-diacritics",w="wijmo-formatspan",i="."+G+" input:first",l="."+G+" input:last",wf=["Bold","Italic","UnderLine","StrikeThrough","SubScript","SuperScript","JustifyLeft","JustifyCenter","JustifyRight","JustifyFull","Border","NumberedList","BulletedList","Outdent","Indent"],Jd=["Bold","Italic","Link","BlockQuote","StrikeThrough","InsertDate","InsertImage","NumberedList","BulletedList","InsertCode"],Id=["Bold","Italic","StrikeThrough","UnderLine","ForeColor","FontSize","Link","InsertImage","NumberedList","BulletedList","BlockQuote"],ze={Form:{name:"form",tip:"Form",css:kf},Image:{name:"imagebutton",tip:"Image Button",css:Xd},TextArea:{name:"textarea",tip:"TextArea",css:Ge},Button:{name:"button",tip:"Button",css:Ue},TextBox:{name:"textbox",tip:"TextBox",css:Re},List:{name:"list",tip:"ListBox",css:Oe},PasswordField:{name:"passwordfield",tip:"Password Field",css:Ee},DropDownList:{name:"dropdownlist",tip:"DropDownList",css:Od},HiddenField:{name:"hiddenfield",tip:"Hidden Field",css:Wd},Radio:{name:"radio",tip:"RadioButton",css:ef},CheckBox:{name:"checkbox",tip:"CheckBox",css:Be},InsertColumn:{name:"insertcol",tip:"Insert Column",css:re},InsertRow:{name:"insertrow",tip:"Insert Row",css:se},InsertCell:{name:"insertcell",tip:"Insert Cell",css:je},SplitCell:{name:"splitcell",tip:"Split Cell",css:we},MergeCell:{name:"mergecell",tip:"Merge Cell",css:te},DeleteColumn:{name:"deletecol",tip:"Delete Column",css:pe},DeleteRow:{name:"deleterow",tip:"Delete Row",css:qe},DeleteCell:{name:"deletecell",tip:"Delete Cell",css:ge},JustifyLeft:{name:"justifyleft",tip:"Justify Left",css:ae,grpname:"alignment"},JustifyCenter:{name:"justifycenter",tip:"Justify Center",css:Kd,grpname:"alignment"},JustifyRight:{name:"justifyright",tip:"Justify Right",css:Qd,grpname:"alignment"},JustifyFull:{name:"justifyfull",tip:"Justify Full",css:Zd,grpname:"alignment"},Border:{name:"borders",tip:"Border",css:Le},NumberedList:{name:"insertorderedlist",tip:"Numbered List",css:ue,grpname:"list"},BulletedList:{name:"insertunorderedlist",tip:"Bulleted List",css:de,grpname:"list"},Outdent:{name:"outdent",tip:"Outdent",css:Pe,grpname:"block"},Indent:{name:"indent",tip:"Indent",css:Ve,grpname:"block"},BackColor:{name:"backcolor",tip:"Background Color",css:Ke},ForeColor:{name:"fontcolor",tip:"Font Color",css:bf},Bold:{name:"bold",tip:"Bold",css:gf},Italic:{name:"italic",tip:"Italic",css:We},StrikeThrough:{name:"strikethrough",tip:"Strikethrough",css:Ze},UnderLine:{name:"underline",tip:"Underline",css:ye},SubScript:{name:"subscript",tip:"Subscript",css:yf},SuperScript:{name:"superscript",tip:"Superscript",css:zf},Template:{name:"template",tip:"Template",css:Fe},RemoveFormate:{name:"removeformat",tip:"RemoveFormat",css:Rd},InsertBreak:{name:"insertbreak",tip:"Insert Break",css:Yd},InsertParagraph:{name:"insertparagraph",tip:"Insert Paragraph",css:Ed},InsertPrint:{name:"insertprintpagebreak",tip:"Insert Print Page Break",css:Ad},InsertHR:{name:"inserthorizontalrule",tip:"Insert Horizontal Line",css:De},Table:{name:"tablebutton",tip:"Table",css:Uc},InsertTable:{name:"inserttable",tip:"Insert Table",css:zc},EditTable:{name:"edittable",tip:"Edit Table",css:Fc},Wysiwyg:{name:"wysiwyg",tip:"Design View",css:he,grpname:"modes"},Split:{name:"split",tip:"Split View",css:xe,grpname:"modes"},Code:{name:"code",tip:"Source View",css:le,grpname:"modes"},Wordwrap:{name:"wordwrap",tip:"Wordwrap",css:He},FullScreen:{name:"fullscreen",tip:"Fullscreen",css:ie},Undo:{name:"undo",tip:"Undo",css:pf},Redo:{name:"redo",tip:"Redo",css:nf},Preview:{name:"preview",tip:"Preview",css:Qe},Cleanup:{name:"cleanup",tip:"Clean up",css:Me},Cut:{name:"cut",tip:"Cut",css:xf},Copy:{name:"copy",tip:"Copy",css:hf},Paste:{name:"paste",tip:"Paste",css:df},SelectAll:{name:"selectall",tip:"Select All",css:ve},Media:{name:"media",tip:"Media",css:cf},InsertSpecialChar:{name:"specialchar",tip:"Insert Special Character",css:be},InsertDate:{name:"datetime",tip:"Insert Date Time",css:Ce},Find:{name:"find",tip:"Find And Replace",css:jf,text:"Find"},Inspect:{name:"inspect",tip:"Tag Inspect",css:Ne,text:"Inspect"},Save:{name:"save",tip:"Form",css:of,text:"Save"},Spelling:{name:"spelling",tip:"Form",css:""},InsertImage:{name:"imagebrowser",tip:"Image Browser",css:Pd},Link:{name:"link",tip:"Link",css:lf,text:"Link"},FontName:{name:"fontname",tip:"Font Name",css:ob},FontSize:{name:"fontsize",tip:"Font Size",css:ob},BlockQuote:{name:"blockquote",tip:"Block Quote",css:fe},InsertCode:{name:"insertcode",tip:"Insert Code",css:ke}},ec=function(){var a=this,b=[];a.append=function(a){b.push(a)};a.toString=function(){return b.join("")};a.dispose=function(){b=null}},Df=function(a){this.text=a;this.render=function(){return this.text}},fb=function(f,c,d){var b=this,e={br:true,img:true,hr:true,input:true};b.tagName=f||"div";b.attributes=d||{};b.innerText=c||"";b.children=[];if(a.isPlainObject(c)){b.innerText="";b.attributes=c}b._isShortTag=false;if(e[b.tagName]===true)b._isShortTag=true;b.render=function(){var c=new ec,d="";c.append(b._renderBeginTag(b.tagName,b.attributes));b.innerText!==""&&c.append(b.innerText);b.children.length>0&&a.each(b.children,function(b,a){c.append(a.render())});c.append(b._renderEndTag(b.tagName));d=c.toString();c.dispose();return d};b.add=function(a){this.children.push(a)};b._renderBeginTag=function(e,d){var b=new ec,c="";b.append("<");b.append(e);a.each(d,function(c,a){b.append(" ");b.append(c);b.append("=");b.append('"');b.append(a.toString());b.append('"')});if(this._isShortTag)b.append(" ");else b.append(">");c=b.toString();b.dispose();return c};b._renderEndTag=function(c){var a=new ec,b="";if(this._isShortTag)a.append("/>");else{a.append("</");a.append(c);a.append(">")}b=a.toString();a.dispose();return b}};a.widget("wijmo.wijeditor",{options:{fullScreenContainerSelector:"",editorMode:"wysiwyg",fullScreenMode:false,showPathSelector:true,mode:"ribbon",commandButtonClick:null,simpleModeCommands:null,showFooter:true,customContextMenu:true},_create:function(){var a=this;if(a.element.is("input"))return;a._editorify();a._initElements();n.setTimeout(function(){a.options.disabled&&a._handleDisabledOption(true,a.editor)},40)},_createBigButton:function(f,e,c,d){var b=this,a=b._createElement("button",{title:f,name:c,"class":Ec});a.add(b._createDiv(e));a.add(b._createSpan("",d));return a},_createTextButton:function(c,a,b){return this._createElement("button",b,{title:c,name:a})},_createButton:function(f,e,c,d){var b=this,a;if(!d)return b._createElement("button",{title:f,name:c,"class":e});a=b._createElement("button",{title:f,name:c});a.add(b._createSpan(e));a.add(b._createSpan("",d));return a},_createTextRadioButton:function(g,c,b,e,f){var d=this,a=[];a.push(d._createElement("input",{id:c+b,type:"radio",name:e}));a.push(d._createElement("label",f,{"for":c+b,title:g,name:b}));return a},_createImageRadioButton:function(g,c,f,b,e){var d=this,a=[];a.push(d._createElement("input",{id:c+b,type:"radio",name:e}));a.push(d._createElement("label",{"for":c+b,title:g,name:b,"class":f}));return a},_createImageCheckButton:function(f,c,e,b){var d=this,a=[];a.push(d._createElement("input",{id:c+b,type:"checkbox"}));a.push(d._createElement("label",{"for":c+b,title:f,name:b,"class":e}));return a},_createRibbonList:function(){return this._createSpan(mf)},_createDropdownButton:function(f,e,i,h,g){var b=this,c=b._createElement("div",{title:f,"class":ob}),d=b._createElement("ul");c.add(b._createTextButton(f,e,i));c.add(d);a.each(h,function(i,c){var f=b._createElement("li"),h=b._createTextRadioButton(c.tip,g,c.name,e,c.text);a.each(h,function(b,a){f.add(a)});d.add(f)});return c},_createSplitButton:function(e,i,g,h,f){var b=this,c=b._createElement("div",{title:e,"class":ce}),d=b._createElement("ul");c.add(b._createBigButton(e,i,g,h));c.add(b._createElement("button",{"class":Ec}));c.add(d);a.each(f,function(e,a){var c=b._createElement("li");c.add(b._createButton(a.tip,a.css,a.name,a.text));d.add(c)});return c},_createButtonByCommand:function(e){var b=this,c,a=ze[e],d;if(!a)return;d=a.name;switch(d){case Yc:case yd:case Wc:case jd:case sd:case pd:case md:case hd:case Rc:case Vc:case ud:case fd:case Hb:case ac:case Tb:case cc:case M:case Ib:case bc:case Vb:case Jb:case Xc:case Gc:case Cc:case Zc:case E:case H:case sc:case nc:case lc:case xd:case N:case Yb:case Zb:case od:case hc:case kc:case Pb:case fc:case Gb:case Ub:case gd:case ed:c=b._createButton(a.tip,a.css,d);break;case oc:case ic:c=b._createButton(a.tip,a.css,d,a.text);break;case ld:case x:case v:case mb:case gb:case bb:case jb:c=b._createImageCheckButton(a.tip,B,a.css,d);break;case Sb:case dc:case Wb:case ab:case V:case W:case Z:case nd:case td:case S:case R:c=b._createImageRadioButton(a.tip,B,a.css,d,a.grpname);break;case mc:c=b._createSplitButton("Table",Uc,mc,"Table",[{tip:"Insert Table",css:zc,name:Ob,text:"Insert"},{tip:"Edit Table",css:Fc,name:dd,text:"Edit"}]);break;case qc:if(b.options.mode==="ribbon")c=b._createBigButton(a.tip,a.css,d,a.text);else c=b._createButton(a.tip,Ye,d);break;case pc:if(b.options.mode==="ribbon")c=b._createBigButton(a.tip,a.css,d,a.text);else c=b._createButton(a.tip,Xe,d);break;case t:c=b._createDropdownButton("Font Name",t,"Font Name",[{tip:"Arial",name:"fn1",text:"Arial"},{tip:"Courier New",name:"fn2",text:"Courier New"},{tip:"Garamond",name:"fn3",text:"Garamond"},{tip:"Tahoma",name:"fn4",text:"Tahoma"},{tip:"Times New Roman",name:"fn5",text:"Times New Roman"},{tip:"Verdana",name:"fn6",text:"Verdana"},{tip:"Wingdings",name:"fn7",text:"Wingdings"}],B);break;case y:c=b._createDropdownButton("Font Size",y,"Font Size",[{tip:"VerySmall",name:"xx-small",text:"VerySmall"},{tip:"Smaller",name:"x-small",text:"Smaller"},{tip:"Small",name:"small",text:"Small"},{tip:"Medium",name:"medium",text:"Medium"},{tip:"Large",name:"large",text:"Large"},{tip:"Larger",name:"x-large",text:"Larger"},{tip:"VeryLarge",name:"xx-large",text:"VeryLarge"}],B)}return c},_createActionGroup:function(){var a=this,c=a._createElement("li"),b=a._createRibbonList();c.add(a._createButtonByCommand("Save"));c.add(b);b.add(a._createButtonByCommand("Undo"));b.add(a._createButtonByCommand("Redo"));b=a._createRibbonList();c.add(b);b.add(a._createButtonByCommand("Preview"));b.add(a._createButtonByCommand("Cleanup"));b=a._createRibbonList();c.add(b);b.add(a._createButtonByCommand("Cut"));b.add(a._createButtonByCommand("Copy"));b.add(a._createButtonByCommand("Paste"));b.add(a._createButtonByCommand("SelectAll"));c.add(a._createElement("div","Actions"));return c},_createFontGroup:function(){var b=this,d=b._createElement("li"),c=b._createRibbonList();d.add(b._createButtonByCommand("FontName"));d.add(b._createButtonByCommand("FontSize"));d.add(c);c.add(b._createButtonByCommand("BackColor"));c.add(b._createButtonByCommand("ForeColor"));c=b._createRibbonList();d.add(c);a.each(b._createButtonByCommand("Bold"),function(b,a){c.add(a)});a.each(b._createButtonByCommand("Italic"),function(b,a){c.add(a)});a.each(b._createButtonByCommand("UnderLine"),function(b,a){c.add(a)});a.each(b._createButtonByCommand("StrikeThrough"),function(b,a){c.add(a)});a.each(b._createButtonByCommand("SubScript"),function(b,a){c.add(a)});a.each(b._createButtonByCommand("SuperScript"),function(b,a){c.add(a)});c=b._createRibbonList();d.add(c);c.add(b._createButtonByCommand("Template"));c=b._createRibbonList();d.add(c);c.add(b._createButtonByCommand("RemoveFormate"));d.add(b._createElement("div","Font"));return d},_createParaGroup:function(){var c=this,d=c._createElement("li"),b=c._createRibbonList();d.add(b);a.each(c._createButtonByCommand("JustifyLeft"),function(c,a){b.add(a)});a.each(c._createButtonByCommand("JustifyCenter"),function(c,a){b.add(a)});a.each(c._createButtonByCommand("JustifyRight"),function(c,a){b.add(a)});a.each(c._createButtonByCommand("JustifyFull"),function(c,a){b.add(a)});b=c._createRibbonList();d.add(b);a.each(c._createButtonByCommand("Border"),function(c,a){b.add(a)});b=c._createRibbonList();d.add(b);a.each(c._createButtonByCommand("NumberedList"),function(c,a){b.add(a)});a.each(c._createButtonByCommand("BulletedList"),function(c,a){b.add(a)});b=c._createRibbonList();d.add(b);a.each(c._createButtonByCommand("Outdent"),function(c,a){b.add(a)});a.each(c._createButtonByCommand("Indent"),function(c,a){b.add(a)});d.add(c._createElement("div","Paragraph"));return d},_createReviewGroup:function(){var b=this,a=b._createElement("li");a.add(b._createButtonByCommand("Inspect"));a.add(b._createButtonByCommand("Find"));a.add(b._createElement("div","Review"));return a},_createTablesGroup:function(){var a=this,c=a._createElement("li"),b=a._createRibbonList();c.add(a._createButtonByCommand("Table"));c.add(b);b.add(a._createButtonByCommand("InsertColumn"));b.add(a._createButtonByCommand("InsertRow"));b.add(a._createButtonByCommand("InsertCell"));b=a._createRibbonList();c.add(b);b.add(a._createButtonByCommand("SplitCell"));b.add(a._createButtonByCommand("MergeCell"));b=a._createRibbonList();c.add(b);b.add(a._createButtonByCommand("DeleteColumn"));b.add(a._createButtonByCommand("DeleteRow"));b.add(a._createButtonByCommand("DeleteCell"));c.add(a._createElement("div","Tables"));return c},_createBreaksGroup:function(){var b=this,a=b._createElement("li");a.add(b._createButtonByCommand("InsertBreak"));a.add(b._createButtonByCommand("InsertParagraph"));a.add(b._createButtonByCommand("InsertPrint"));a.add(b._createButtonByCommand("InsertHR"));a.add(b._createElement("div","Breaks"));return a},_createFormsGroup:function(){var b=this,c=b._createElement("li"),a=b._createRibbonList();c.add(a);a.add(b._createButtonByCommand("Form"));a=b._createRibbonList();c.add(a);a.add(b._createButtonByCommand("TextArea"));a.add(b._createButtonByCommand("TextBox"));a.add(b._createButtonByCommand("PasswordField"));a.add(b._createButtonByCommand("HiddenField"));a=b._createRibbonList();c.add(a);a.add(b._createButtonByCommand("Image"));a.add(b._createButtonByCommand("Button"));a=b._createRibbonList();c.add(a);a.add(b._createButtonByCommand("List"));a.add(b._createButtonByCommand("DropDownList"));a.add(b._createButtonByCommand("Radio"));a.add(b._createButtonByCommand("CheckBox"));c.add(b._createElement("div","Forms"));return c},_createSpecialGroup:function(){var b=this,a=b._createElement("li");a.add(b._createButtonByCommand("Link"));a.add(b._createButtonByCommand("InsertImage"));a.add(b._createButtonByCommand("Media"));a.add(b._createButtonByCommand("InsertSpecialChar"));a.add(b._createButtonByCommand("InsertDate"));a.add(b._createElement("div","Special"));return a},_getDefaultRibbonMarkup:function(){var a=this,d=a._createElement("div"),e=a._createElement("ul"),g=a._createElement("li"),i=a._createElement("li"),f=a._createElement("div",{id:B+"format"}),h=a._createElement("div",{id:B+"insert"}),b=a._createElement("ul"),c=a._createElement("ul");d.add(e);d.add(f);d.add(h);e.add(g);e.add(i);g.add(a._createElement("a","Format",{href:"#"+B+"format"}));i.add(a._createElement("a","Insert",{href:"#"+B+"insert"}));f.add(b);b.add(a._createActionGroup());b.add(a._createFontGroup());b.add(a._createParaGroup());b.add(a._createReviewGroup());h.add(c);c.add(a._createTablesGroup());c.add(a._createBreaksGroup());c.add(a._createFormsGroup());c.add(a._createSpecialGroup());return d.render()},_getRibbonModesMarkup:function(){var b=this,d=b._createDiv(Tc),c=b._createRibbonList();d.add(c);a.each(b._createButtonByCommand("Wysiwyg"),function(b,a){c.add(a)});a.each(b._createButtonByCommand("Code"),function(b,a){c.add(a)});a.each(b._createButtonByCommand("Split"),function(b,a){c.add(a)});d.add(b._createButtonByCommand("Wordwrap"));d.add(b._createButtonByCommand("FullScreen"));return d.render()},_getSimpleToolBar:function(e){var d=this,b,c=d._createDiv("");a.each(e,function(f,e){b=d._createButtonByCommand(e);if(b)if(a.inArray(e,wf)!==-1)a.each(b,function(b,a){c.add(a)});else c.add(b)});return c.render()},_editorify:function(){var b=this,d=b.element,p=d.width(),o=d.height(),f=b.options,m=f.mode,g,j,l,k,i,h,n;b._oriStyle=d.attr("style");b._oriContent=d.html();if(d.is("textarea")){if(m==="ribbon")c=a(b._getDefaultRibbonMarkup());else if(m==="bbcode")c=a(b._getSimpleToolBar(Id));else if(f.simpleModeCommands&&f.simpleModeCommands.length!==0){l=a.grep(f.simpleModeCommands,function(a){return a!=="Table"});c=a(b._getSimpleToolBar(l))}else c=a(b._getSimpleToolBar(Jd));b.sourceView=d;b.editor=d.wrap("<div></div>").parent();b.editor.width(p).height(o)}else{b.editor=d;c=d.children(":eq(0)");h=d.children(":eq(1)");if(h.is("textarea"))b.sourceView=h;else{n=h.html();h.remove();b.sourceView=a("<textarea></textarea>").val(n)}}g=a("<div class='"+oe+"'></div>");b.dialog=a("<div class ='"+e+"'></div>");b.subDialog=a("<div class ='"+e+"'></div>");b.editor.addClass(e).append(g).append(b.dialog).append(b.subDialog);b._createMenuMarkUp(b,f);c.wrap("<a href='#'></a>").parent().appendTo("<div class='"+Oc+" ui-widget-header ui-helper-clearfix ui-corner-top'></div>").parent().appendTo(g);j=a("<div class='"+Lc+"'></div>").appendTo(g);b.designView=a("<iframe frameborder='0'></iframe>");b.designView.wrap("<div></div>").parent().appendTo(j);b.sourceView.wrap("<div></div>").parent().appendTo(j);k=[c];I=a(b._getRibbonModesMarkup());if(f.showFooter){i=a("<div class='"+Nc+" ui-widget ui-widget-content ui-state-default'></div>");g.append(i);i.append("<div class='"+wc+"'></div>");I.appendTo(i);k.push(I)}a.each(k,function(c,a){a.wijribbon({click:function(c,a){b._ribbonCommand(a.commandName,a.name);b._trigger("commandButtonClick",c,a)}})})},_createMenuMarkUp:function(b,c){if(c.customContextMenu&&!a.browser.webkit){b.contextMenu=a("<ul><li _c1buttoncmd='cut'><a>Cut</a></li><li _c1buttoncmd='copy'><a>Copy</a></li><li _c1buttoncmd='paste'><a>Paste</a></li></ul>");a("<a href='#'></a>").append(b.contextMenu).appendTo(b.editor)}},_handleDisabledOption:function(b,c){var a=this;if(b){if(!a.disabledDiv)a.disabledDiv=a._createDisabledDiv(c);a.disabledDiv.appendTo("body")}else if(a.disabledDiv){a.disabledDiv.remove();a.disabledDiv=null}},_createDisabledDiv:function(d){var g=this,b=d?d:g.element,c=b.offset(),f=b.outerWidth(),e=b.outerHeight();return a("<div></div>").addClass("ui-state-disabled").css({"z-index":"99999",position:"absolute","background-color":"lightgray",width:f,height:e,left:c.left,top:c.top})},_initElements:function(){var a=this,b=a.options,e=a.element.height()-a._getHeader().outerHeight(true)-a._getFooter().outerHeight(true),d={};a._getContent().height(e).wijsplitter({showExpander:false,orientation:"horizontal",panel1:{scrollBars:"none",collapsed:false},panel2:{scrollBars:"none",collapsed:true}});a._addHandlerToDesignView();a._addDefaultFontStyleToDesignView();a._createWijMenu();(!b.showPathSelector||a.options.mode==="bbcode")&&a._getPathSelector().hide();a._ribbonCommand(b.editorMode);b.fullScreenMode&&a._setFullScreen(b.fullScreenMode);d[H]=true;d[E]=true;c.wijribbon(Cb,d)},_setOption:function(d,c){var b=this,e=b.options,f=e.customContextMenu;a.Widget.prototype._setOption.apply(b,arguments);if(d==="fullScreenMode"){e.fullScreenMode=c;b._setFullScreen(c)}else if(d==="showPathSelector"){e.showPathSelector=c;if(c)b._getPathSelector().show();else b._getPathSelector().hide()}else if(d==="editorMode"){e.editorMode=c;b._ribbonCommand(c)}else if(d==="fullScreenContainerSelector"){e.fullScreenContainerSelector=c;b.options.fullScreenMode&&b._setFullScreen(true)}else if(d==="disabled")b._handleDisabledOption(c,b.editor);else if(d==="commandButtonClick")e.commandButtonClick=c;else if(d==="customContextMenu"){if(f===c)return;if(c){!b.contextMenu&&b._createMenuMarkUp(b,e);b._createWijMenu()}else{b.contextMenu.wijmenu("destroy").remove();b.contextMenu=undefined}}},_getHeader:function(){return a("."+Oc,this.editor)},_getContent:function(){return a("."+Lc,this.editor)},_getFooter:function(){return a("."+Nc,this.editor)},_getPathSelector:function(){return a("."+wc,this.editor)},_getModes:function(){return a("."+Tc,this.editor)},_getDesignView:function(){return this.designView},_getDesignViewWindow:function(){var a=this.designView;return a&&a.length>0?a[0].contentWindow:null},_getDesignViewDocument:function(){var a=this._getDesignViewWindow();return a?a.document:null},_getDesignViewText:function(){var a=this._getDesignViewDocument();return a&&a.body&&a.body.innerHTML?a.body.innerHTML:""},_setDesignViewText:function(a){var c=this,b=this._getDesignViewDocument();if(this.options.mode==="bbcode")a=c._convertBBCodeToHtml(a);if(b&&b.body)b.body.innerHTML=a},_getDialog:function(){return this.dialog},_getSubDialog:function(){return this.subDialog},_initContentDocument:function(){var b=this,c=b.sourceView.val(),d=b._getDesignViewDocument();if(b.options.mode==="bbcode")c=b._convertBBCodeToHtml(a.trim(c));d.open();d.write('<html style="width:100%;height:100%;'+(b.options.enabled?"cursor:text;":"")+'"><head><title></title><style id="__wijStyle"  type="text/css" >table,td,tr{border: 1px #acacac dashed;}</style></head><body>'+c+"</body></html>");d.close();A=[];A.push(c);k=0},_addHandlerToDesignView:function(){var b=this,d=b._getDesignViewWindow(),c=d.document;b._initContentDocument();if(a.browser.mozilla)setTimeout(b._setDesignModeForFF,1e3,b);else b._setContentEditable(c,true);b.sourceView.bind("blur."+b.widgetName,function(){b._onSourceViewBlur()});b.sourceView.bind("keyup."+b.widgetName,function(){b._onSourceViewBlur()});if(!a.browser.mozilla)a(d).blur(function(){b._onDesignViewBlur()});else a(c).bind("blur."+b.widgetName,function(){b._onDesignViewBlur()});a(c).bind("mouseup."+b.widgetName,function(a){b._onDesignViewMouseUp(a)}).bind("keydown."+b.widgetName,function(a){b._onDesignViewKeyDown(a)}).bind("keyup."+b.widgetName,function(a){b._onDesignViewKeyUp(a);b._onDesignViewBlur()})},_addDefaultFontStyleToDesignView:function(){var e=this,f=e.options,g=e._getDesignViewDocument(),b=f.defaultFontName,d=f.defaultFontSize,h="",i="",c='<style type="text/css"> body {';if((b===""||b===null)&&(d===""||d===null))return;if(b!==""&&b!==null)c+="font-family: "+b+";";if(f.defaultFontSize!==""&&f.defaultFontSize!==null)c+=" font-size: "+d+";";c+="}</style>";window.setTimeout(function(){a(c).appendTo(a("head",g))},200);e._setFontStyleButtonState(b,t);e._setFontStyleButtonState(d,y)},_setFontStyleButtonState:function(b,e){var d="";if(!b||b===null)return;a.each(c.wijribbon("getDropdownList",e),function(c,a){if(a.toUpperCase()===b.toUpperCase()){d=c;return false}});c.wijribbon(u,d,true,e)},_setDesignModeForFF:function(a){a._getDesignViewDocument().designMode="on"},destroy:function(){var b=this;b.element.html(b._oriContent);b.element.removeAttr("tabindex");if(b._oriStyle===undefined)b.element.removeAttr("style");else b.element.attr("style",b._oriStyle);b.element.insertBefore(b.editor);b.element.unbind("."+b.widgetName);b.editor.remove();a.Widget.prototype.destroy.call(b)},showEditorDialog:function(a){switch(a){case Ob:case fc:case Gb:case ic:case oc:case Pb:case kc:case hc:case pc:case Yb:case Zb:case Ub:this._ribbonCommand(a);break;default:d("Cannot find the dialog with command name '"+a+"'!")}},executeEditorAction:function(b,a){this._ribbonCommand(b,a)},_isFontSizeCustomized:function(){if(J!==null)return J;var b=c.wijribbon("getDropdownList",y),d=[db,eb,lb,ib,kb,hb,cb];J=false;a.each(b,function(b){if(a.inArray(b,d)===-1){J=true;return false}});return J},_fontSizeCommand:function(e){var c=this,d=c._getDesignViewDocument(),b=4,f="font-size",g=[];switch(e){case db:b=1;break;case eb:b=2;break;case lb:b=3;break;case ib:b=4;break;case kb:b=5;break;case hb:b=6;break;case cb:b=7}if(!c._isFontSizeCustomized())d.execCommand("FontSize",false,b);else if(a.browser.msie)c._formatFontSpan(d,f,e);else{d.execCommand("FontSize",false,b);a.each(a("font[size]",d),function(d,b){g.push(c._replaceFontWithSpan(a(b),"size",f,e))});c._setSelection(g)}c.options.mode==="bbcode"&&!a.browser.msie&&c._convertFontStyleToStandTag();c._addtoUndoBuffer()},_fontNameCommand:function(g){var b=this,e=b._getDesignViewDocument(),f=c.wijribbon("getDropdownList",t),d;a.each(f,function(b,a){if(g===b){d=a;return false}});e.execCommand("FontName",false,d);b._isFontSizeCustomized()&&a.browser.msie&&b._formatFontSpan(e,"font-family",d);b._addtoUndoBuffer()},_formatFontSpan:function(h,b,f){var c=this,e=f,d="fontFamily",g=[];if(b!=="font-family"){e="c1-temp";d="fontSize"}h.execCommand("FontName",false,e);a.each(a("font[face='"+e+"']",h),function(k,j){var i=c._replaceFontWithSpan(a(j),"face",b,f),h,e;g.push(i);h=a("span."+w,i);for(e=h.length-1;e>=0;e--)c._removeSpecifiedStyleSpan(a(h[e]),d,b);a.each(i,function(f,e){a.each(a(e).parents("span."+w),function(h,g){var f=a(g);if(f.children().length>1)return false;f.text()===a(e).text()&&c._removeSpecifiedStyleSpan(f,d,b)})})});c._setSelection(g)},_setSelection:function(c,k,j){var i=this._getDesignViewWindow(),g=i.document,b,f,e,d,h=0;try{if(a.browser.msie){b=g.selection.createRange();if(c){a.each(c,function(b,a){h+=a.text().length});b.moveToElementText(c[0][0]);b.collapse(true);b.moveEnd("character",h)}else{b.moveStart("textedit",-1);b.collapse(true);b.moveStart("character",k);b.moveEnd("character",j)}b.select()}else{d=i.getSelection();b=g.createRange();f=c[0][0];e=c[c.length-1][0];b.setStart(f,0);b.setEnd(e,e.childNodes.length);d.removeAllRanges();d.addRange(b)}}catch(l){}},_replaceFontWithSpan:function(a,c,e,d){a.wrap("<span class = '"+w+"' style='"+e+":"+d+"'></span>");var b=a.parent();a.removeAttr(c);if(/<font\s*>/ig.test(b.html())){b.html(a.html());a.remove()}return b},_removeSpecifiedStyleSpan:function(b,f,e){var c,d=true;b[0].style[f]!==""&&b.css(e,"");c=b.attr("style");c&&a.each(c.split(";"),function(f,c){var b=a.trim(c).toLowerCase();if(b!==""&&b.indexOf(e)!==-1){d=false;return false}});d&&b.replaceWith(b.html())},_removeFormat:function(){var d=this,e=d._getDesignViewDocument(),b={};e.execCommand(Jb,false,null);d._isFontSizeCustomized()&&a.browser.msie&&d._removeFormatForIE(e);d._addtoUndoBuffer();b[mb]=false;b[gb]=false;b[jb]=false;b[bb]=false;b[x]=false;b[v]=false;b[S]=false;b[R]=false;b[ab]=false;b[V]=false;b[W]=false;b[Z]=false;c.wijribbon(Qc,b)},_removeFormatForIE:function(g){var i=g.selection.createRange(),k=i.htmlText,s=i.text,p=0,r=a(i.parentElement()),m=a(g.body),o="",l="",h="__c1temp",j="c1-temp",q="<span class='"+j+"'>"+h+"</span>",b,f,e,d,c,n;r.addClass("c1-app-parent");i.pasteHTML(q);p=m.text().indexOf(h);b=a("span."+j,g);f=b;b.parentsUntil("body").each(function(){if(a(this).is(".c1-app-parent"))return false;f=a(this)});b.html(k);e=a("span."+w,b);for(c=e.length-1;c>=0;c--){d=a(e[c]);d.replaceWith(d.html())}!f.is("."+j)&&f.after(b);a.each(f.parents("span."+w),function(c,b){o+="</span>";l="<span class='"+w+"' style = '"+a(b).attr("style")+"'>"+l});k=b.html();b.replaceWith(h);n=m.html().split(h);m.html(n[0]+o+k+l+n[1]);e=a("span."+w,g);for(c=e.length-1;c>=0;c--){d=a(e[c]);d.text()===""&&d.replaceWith(d.html())}a(".c1-app-parent",g).removeClass("c1-app-parent");this._setSelection(null,p,s.length)},_toggleFullScreen:function(){var b=this,a=b.options;a.fullScreenMode=!a.fullScreenMode;b._setFullScreen(a.fullScreenMode)},_setFullScreen:function(i){var b=this,j=1,m=b._getHeader(),l=b._getFooter(),k=b._getContent(),e=b.options.fullScreenContainerSelector,d=a(e),h,g,f;if(i){if(d.length===0){d=a(n);e="body";b._oriDocOverFlow=a(document.documentElement).css("overflow");a(document.documentElement).css({overflow:"hidden"});!a.browser.mozilla&&window.scrollTo(0,0);a(n).bind("resize.wijeditor",function(){b._fullscreenOnWindowResize()})}h=d.width();g=d.height()-2*j;zd=b.editor.width();vd=b.editor.height();if(!rd)rd=b.editor.parent();if(!b._replacedDiv)b._replacedDiv=a("<div />");b.editor.after(b._replacedDiv);a(e).append(b.editor);b.editor.css({width:h,height:g,position:""}).addClass(Ac);c.wijribbon("updateRibbonSize")}else{b._replacedDiv.after(b.editor).remove();b.editor.css({width:zd,height:vd,position:"static"}).removeClass(Ac);!b.options.fullScreenContainerSelector&&a(document.documentElement).css({overflow:b._oriDocOverFlow});a(n).unbind("resize.wijeditor");c.wijribbon("updateRibbonSize")}f=b.editor.height()-m.outerHeight(true)-l.outerHeight(true);k.height(f).wijsplitter("refresh");b._addHandlerToDesignView();b._addDefaultFontStyleToDesignView();b._createWijMenu()},_createWijMenu:function(){var b=this;b.contextMenu&&b.contextMenu.wijmenu({orientation:"vertical",trigger:b.designView,triggerEvent:"rtclick",showing:function(i,c){c.show();var d=b.designView.offset(),e=a(a(b.designView)[0].contentWindow).scrollLeft(),f=a(a(b.designView)[0].contentWindow).scrollTop(),g=d.left+2-e,h=d.top-f;c.position({my:"left top",at:"right top",of:i,offset:g+" "+h,collision:"none none"});c.hide()},animation:{animated:"fade"},select:function(c,a){b._contextMenuItemClick(c,a)}})},_fullscreenOnWindowResize:function(){var b=this,h=b._getHeader(),f=b._getFooter(),d=b._getContent(),c,g=a(window).width(),e=a(window).height();b.editor.css({width:g,height:e});c=b.editor.height()-h.height()-f.height();d.height(c).wijsplitter("refresh")},_saveText:function(){},_doSpellCheck:function(){},_ribbonCommand:function(h,k){var b=this,e=b._getDesignViewDocument(),i=b._getContent(),d,g,f;if(k===t){b._fontNameCommand(h);b._onDesignViewBlur();return}if(k===y){b._fontSizeCommand(h);b._onDesignViewBlur();return}b._setIEFocus();switch(h){case Yc:if(a.browser.msie){e.execCommand("FormatBlock",false,"<ADDRESS>");f=e.selection.createRange();f=a(f.parentElement()).closest("address");if(f.length){f.replaceWith("<blockquote>"+f.html()+"</blockquote>");e.body.innerHTML=e.body.innerHTML.replace(/<BLOCKQUOTE>\s*?<BLOCKQUOTE>/gi,"<BLOCKQUOTE>");e.body.innerHTML=e.body.innerHTML.replace(/<\/BLOCKQUOTE>\s*?<\/BLOCKQUOTE>/gi,"</BLOCKQUOTE>");e.body.innerHTML=e.body.innerHTML.replace(/<BLOCKQUOTE>\s*?<\/BLOCKQUOTE>/gi,"")}}else e.execCommand("FormatBlock",false,"<BLOCKQUOTE>");break;case yd:d=b._generateUniqueName("form");b.insertHTML('<form id="'+d+'" name="'+d+'" method="post">'+d+"</form>");break;case Wc:d=b._generateUniqueName("image");b.insertHTML('<input id="'+d+'" name="'+d+'" type="image" value="'+d+'"/>');break;case jd:d=b._generateUniqueName("textarea");b.insertHTML('<textarea id="'+d+'" name="'+d+'" rows="4" cols="48"></textarea>');break;case sd:d=b._generateUniqueName("button");b.insertHTML('<input id="'+d+'" name="'+d+'" type="button" value="'+d+'"/>');break;case pd:d=b._generateUniqueName("textbox");b.insertHTML('<input id="'+d+'" name="'+d+'" type="text" value="'+d+'"/>');break;case md:d=b._generateUniqueName("list");b.insertHTML('<select id="'+d+'" name="'+d+'" style="width: 120px" size="8"></select>');break;case hd:d=b._generateUniqueName("password");b.insertHTML('<input id="'+d+'" name="'+d+'" type="password" value="'+d+'"/>');break;case Rc:d=b._generateUniqueName("dropdown");b.insertHTML('<select id="'+d+'" name="'+d+'"></select>');break;case Vc:d=b._generateUniqueName("hidden");b.insertHTML('<input id="'+d+'" name="'+d+'" type="hidden" value="'+d+'" />');break;case ud:d=b._generateUniqueName("radiobox");b.insertHTML('<input id="'+d+'" name="'+d+'" type="radio" value="'+d+'"><label for="'+d+'">'+d+"</label></input>");break;case fd:d=b._generateUniqueName("checkbox");b.insertHTML('<input id="'+d+'" name="'+d+'" type="checkbox" value="'+d+'"><label for="'+d+'">'+d+"</label></input>");break;case Hb:case ac:case Tb:case cc:case M:case Ib:case bc:case Vb:b._tableAction(h);break;case ld:b._toggleTableBorders();break;case x:try{if(e.queryCommandState(v)){e.execCommand(v,false,null);c.wijribbon(u,v,false)}}catch(m){}e.execCommand(x,false,null);b._addtoUndoBuffer();break;case v:try{if(e.queryCommandState(x)){e.execCommand(x,false,null);c.wijribbon(u,x,false)}}catch(l){}e.execCommand(v,false,null);b._addtoUndoBuffer();break;case Jb:b._removeFormat();break;case Xc:b.insertHTML("<br/>");break;case Gc:g=b._getSelectedContent();if(!g||g==="")g="&nbsp;";b.insertHTML("<p>"+g+"</p>");break;case Cc:b.insertHTML('<div title="Print Page Break" style="font-size:1px;page-break-before:always;vertical-align:middle;height:1px;background-color:#c0c0c0">&nbsp;</div>');break;case Zc:b._toggleFullScreen();break;case E:b._undoAction();break;case H:b._redoAction();break;case sc:b._execCut();break;case nc:b._execCopy();break;case lc:b._execPaste();break;case xd:b.insertDateAndTime();break;case Sb:I.wijribbon(D,N,true).wijribbon(u,Sb,true);c.wijribbon("option","disabled",false);i.wijsplitter("option","panel2",{collapsed:true});break;case dc:I.wijribbon(D,N,true).wijribbon(u,dc,true);c.wijribbon("option","disabled",false);i.wijsplitter("option",{panel1:{collapsed:false},panel2:{collapsed:false}});break;case Wb:I.wijribbon(D,N,false).wijribbon(u,Wb,true);c.wijribbon("option","disabled",true);i.wijsplitter("option","panel1",{collapsed:true});break;case N:i.wijsplitter("option","panel1").collapsed&&b._toggleWordWrap();break;case Yb:if(a.browser.msie)j=e.selection.createRange();b._createDialog("Set BackColor",b._getDialogRes_BackColor(),b.initBackColorDialog);break;case Zb:if(a.browser.msie)j=e.selection.createRange();b._createDialog("Set ForeColor",b._getDialogRes_ForeColor(),b.initForeColorDialog);break;case Ob:if(a.browser.msie)j=e.selection.createRange();b._createDialog("Insert Table",b._getDialogRes_Table(false),b.initInsertTableDialog);break;case dd:b._getEditableTable()&&b._createDialog("Edit Table",b._getDialogRes_Table(true),b.initEditTableDialog);break;case od:b._createDialog("Preview",b._getDialogRes_Preview(),b.initPreviewDialog);break;case hc:b._createDialog("Clean up source HTML document",b._getDialogRes_CleanUp(),b.initCleanUpDialog);break;case kc:if(a.browser.msie)j=e.selection.createRange();b._createDialog("Insert media",b._getDialogRes_Media(),b.initMediaDialog);break;case Pb:if(a.browser.msie)j=e.selection.createRange();b._createDialog("Insert special character",b._getDialogRes_SpecialCharacter(),b.initSpecialCharacterDialog);break;case oc:b._createDialog("Find and replace",b._getDialogRes_FindAndReplace(),b.initFindDialog);break;case ic:Xb=b._getSelectedElement();b._createDialog("Tag Inspector",b._getDialogRes_TagInspector(),b.initTagInspectorDialog);break;case fc:if(a.browser.msie)j=e.selection.createRange();b._createDialog("Apply Template",b._getDialogRes_Template(),b.initTemplateDialog);break;case Gb:if(a.browser.msie)j=e.selection.createRange();b._createDialog("Image Browser",b._getDialogRes_ImageBrowser(),b.initImageBrowserDialog);break;case pc:if(a.browser.msie)j=e.selection.createRange();b._createDialog("Insert hyperLink",b._getDialogRes_Link(),b.initHyperLinkDialog);break;case Ub:if(a.browser.msie)j=e.selection.createRange();b._createDialog("Insert Code",b._getDialogRes_Code(),b.initInsertCodeDialog);break;case ab:case V:case W:case Z:case nd:case td:case mb:case gb:case bb:case S:case R:case jb:case gd:case ed:e.execCommand(h,false,null);b.options.mode==="bbcode"&&!a.browser.msie&&b._convertStyleToStandTag();b._addtoUndoBuffer();break;case qc:b._saveText();break;case id:b._doSpellCheck()}b._onDesignViewBlur()},_createDialog:function(d,e,c){var b=this,a=b.dialog;a.html("").undelegate(b.widgetName).undelegate("."+b.widgetName).append(e);if(!a.data("wijdialog"))a.wijdialog({width:"auto",height:"auto",modal:true,title:d,position:"center",resizable:false,captionButtons:{pin:{visible:false},refresh:{visible:false},toggle:{visible:false},minimize:{visible:false},maximize:{visible:false}}});else{a.wijdialog("reset");a.wijdialog("option",{width:"auto",height:"auto",title:d})}b._adjustDialogLayoutForIE7();c&&c.call(b);a.wijdialog("open")},_adjustDialogLayoutForIE7:function(){var b=this.dialog;a.browser.msie&&/^7\.[0-9]+/.test(a.browser.version)&&b.wijdialog("option","width",b.parent().width())},_contextMenuItemClick:function(e,b){var a=this,c=b.item.attr("_c1buttoncmd");switch(c){case sc:a._execCut();break;case nc:a._execCopy();break;case lc:a.focus();a._execPaste()}},_execCut:function(){var b=this,c=b._getDesignViewDocument();if(a.browser.safari)d("This function is not supported in current browser. Plesse use (Ctrl + X).");else if(a.browser.msie){c.execCommand("Cut",false,null);b._addtoUndoBuffer()}else{b._execCopy();b._deleteSelectionContent();b._addtoUndoBuffer()}},_execCopy:function(){var b=this,c=b._getDesignViewDocument();if(a.browser.safari)d("This function is not supported in current browser. Plesse use (Ctrl + C).");else if(a.browser.msie){c.execCommand("Copy",false,null);b._addtoUndoBuffer()}else b._copyToClipboard(b._getSelectedContent())},_execPaste:function(){var c=this,b,e=c._getDesignViewDocument();if(a.browser.safari)d("This function is not supported in current browser. Plesse use (Ctrl + V).");else if(a.browser.msie){e.execCommand("Paste",false,null);c._addtoUndoBuffer()}else try{b=c._copyFromClipboard();b&&b!==""&&c.insertHTML(b)}catch(f){}},_getFontSizeCollection:function(){return{"10px":db,"13px":eb,"16px":lb,"18px":ib,"24px":kb,"32px":hb,"48px":cb,1:db,2:eb,3:lb,4:ib,5:kb,6:hb,7:cb}},_updateButtonStates:function(l){var e=this,k=e._getDesignViewDocument(),d,b,h={},j=[mb,gb,jb,bb,x,v,S,R,ab,V,W,Z],g,i=l.target,f=a(i);a.each(j,function(b,a){h[a]=k.queryCommandState(a)});c.wijribbon(Qc,h);d=e._queryCommandValue(t)||"";a.each(c.wijribbon("getDropdownList",t),function(c,a){if(a.toUpperCase()===d.toUpperCase()){b=c;return false}});c.wijribbon(u,b,true,t);if(e._isFontSizeCustomized()){if(f.is("span"))b=i.style.fontSize;else b="";if(b===""){g=f.parents("span."+w);a.each(g,function(c,a){b=a.style.fontSize;if(b&&b!=="")return false})}if(b==="")b=f.css("font-size")}else{d=e._queryCommandValue(y)||"";if(d==="")d=f.css("font-size");a.each(e._getFontSizeCollection(),function(c,a){if(c.toString()===d.toString()){b=a;return false}})}c.wijribbon(u,b,true,y)},_queryCommandValue:function(a){var b=this._getDesignViewDocument();try{if(!b.queryCommandEnabled(a))return null}catch(c){return null}try{return b.queryCommandValue(a)}catch(d){}return null},_escActionAssociated:function(){var b=this,a=b._getDesignViewWindow();a.document.selection!==undefined&&a.document.selection.empty();a.getSelection!==undefined&&a.getSelection().removeAllRanges();b._hideAllDropdownsMenus()},_hideAllDropdownsMenus:function(){var a=this;a.contextMenu&&a.contextMenu.wijmenu("hideAllMenus");c.wijribbon("hideDropdown",t).wijribbon("hideDropdown",y).wijribbon("hideDropdown",mc)},_onDesignViewKeyDown:function(b){var a=this,c;a._setSaveBtnEnabled();try{if(b.ctrlKey)c=String.fromCharCode(b.keyCode).toLowerCase();else switch(b.keyCode){case 27:a._escActionAssociated();break;case 13:case 46:a._addtoUndoBuffer()}}catch(d){}},_onDesignViewKeyUp:function(a){var b=this,c;(a.keyCode===37||a.keyCode===38||a.keyCode===39||a.keyCode===40||a.keyCode===33||a.keyCode===34||a.keyCode===35||a.keyCode===36)&&b._updateButtonStates(a);if(a.ctrlKey){c=String.fromCharCode(a.keyCode).toLowerCase();switch(c){case"y":b._redoAction();a.preventDefault();a.stopPropagation();break;case"z":b._undoAction();a.preventDefault();a.stopPropagation();break;case"x":case"v":b._addtoUndoBuffer()}}},_onDesignViewMouseUp:function(c){var d=this,b;if(c.button===2)return;d._updateButtonStates(c);d._refreshPathSelector();d._hideAllDropdownsMenus();a(document).mouseup();if(a.browser.msie){b=a(c.target).closest("a");if(c.ctrlKey&&b.length>0)try{b.focus();n.open(b[0].href,"_blank")}catch(e){}}},_onDesignViewBlur:function(){var c=this,d=c.options,b;b=c._getDesignViewText();if(d.mode==="bbcode")b=c._convertHtmlToBBCode(a.trim(b));c.sourceView.val(b)},_onSourceViewBlur:function(){var b=this,a;a=b.sourceView.val();b._setDesignViewText(a)},_convertBBCodeToHtml:function(a){a=a.replace(/</g,"&lt;");a=a.replace(/>/g,"&gt;");a=a.replace(/(?:\r\n|\n|\r)/g,"<br>");a=a.replace(/\[EMAIL\]([\s\S]*?)\[\/EMAIL\]/gim,'<a href="mailto:$1">$1</a>');a=a.replace(/\[EMAIL\=([^\]]+)]([\s\S]*?)\[\/EMAIL\]/gim,'<a href="mailto:$1">$2</a>');a=a.replace(/\[URL\]([\s\S]*?)\[\/URL\]/gim,'<a href="$1">$1</a>');a=a.replace(/\[URL\=([^\]]+)]([\s\S]*?)\[\/URL\]/gim,'<a href="$1">$2</a>');a=a.replace(/\[B\]/gim,"<b>");a=a.replace(/\[\/B\]/gim,"</b>");a=a.replace(/\[I\]/gim,"<i>");a=a.replace(/\[\/I\]/gim,"</i>");a=a.replace(/\[S\]/gim,"<strike>");a=a.replace(/\[\/S\]/gim,"</strike>");a=a.replace(/\[U\]/gim,"<u>");a=a.replace(/\[\/U\]/gim,"</u>");a=a.replace(/\[IMG height=(.*?) width=(.*?)](.+?)\[\/IMG\]/gim,'<img height="$1" width = "$2" src="$3"/>');a=a.replace(/\[BLOCK\]/gim,"<blockquote>");a=a.replace(/\[\/BLOCK\]/gim,"</blockquote>");a=a.replace(/\[LIST\=1\]\[\*\]([\s\S]*?)\[\/LIST\]/gim,"<ol><li>$1</li></ol>");a=a.replace(/\[LIST\]\[\*\]([\s\S]*?)\[\/LIST\]/gim,"<ul><li>$1</li></ul>");a=a.replace(/\[\*\]/gim,"</li><li>");a=a.replace(/\[size=([^\]]*?)\]/gi,'<font size="$1">');a=a.replace(/\[\/size\]/gim,"</font>");a=a.replace(/\[color=([^\]]*?)\]/gi,'<font color="$1">');a=a.replace(/\[\/color\]/gim,"</font>");return a},_replaceComplexHtml:function(g){var f,c,d,b,e=a("<div/>").html(g);f=a("img",e);a.each(f,function(){d="[IMG height="+a(this).height()+" width="+a(this).width()+"]"+a(this).attr("src").toString()+"[/IMG]";a(this).replaceWith(d)});c=a("font",e);for(b=c.length-1;b>=0;b--){if(a(c[b]).attr("color")&&a(a(c[b])).attr("size"))d="[Color="+a(a(c[b])).attr("color")+"][Size="+a(a(c[b])).attr("size")+"]"+a(a(c[b])).html()+"[/Size][/Color]";else if(a(a(c[b])).attr("color")&&!a(a(c[b])).attr("size"))d="[Color="+a(a(c[b])).attr("color")+"] "+a(a(c[b])).html()+"[/Color]";else if(a(a(c[b])).attr("size")&&!a(a(c[b])).attr("color"))d="[Size="+a(a(c[b])).attr("size")+"]"+a(a(c[b])).html()+"[/Size]";a(a(c[b])).replaceWith(d)}return e.html()},_convertHtmlToBBCode:function(a){var b=this;if(a==="")return;a=b._replaceComplexHtml(a);a=a.replace(/<br(?=[ \/>]).*?>/gim,"\r\n");a=a.replace(/<a .*?href=(["'])(.+?)\1.*?>(.+?)<\/a>/gi,"[URL=$2]$3[/URL]");a=a.replace(/<a .*?href=(["'])mailto:(.+?)\1.*?>(.+?)<\/a>/gi,"[EMAIL=$2]$3[/EMAIL]");a=a.replace(/<(?:b|strong)>/gim,"[B]");a=a.replace(/<\/(?:b|strong)>/gim,"[/B]");a=a.replace(/<(?:i|em)>/gim,"[I]");a=a.replace(/<\/(?:i|em)>/gim,"[/I]");a=a.replace(/<(?:strike|s)>/gim,"[S]");a=a.replace(/<\/(?:strike|s)>/gim,"[/S]");a=a.replace(/<u>/gim,"[U]");a=a.replace(/<\/u>/gim,"[/U]");a=a.replace(/<blockquote.*?\>/gim,"[BLOCK]");a=a.replace(/\s{0,}<\/blockquote>/gim,"[/BLOCK]");a=a.replace(/(?:\r\n|\r|\n){0,1}<(?:ol)>[\s]*/gim,"[LIST=1]");a=a.replace(/<\/(?:ol)>/gim,"[/LIST]");a=a.replace(/(?:\r\n|\r|\n){0,1}\<(?:ul)>[\s]*/gim,"[LIST]");a=a.replace(/<\/(?:ul)>/gim,"[/LIST]");a=a.replace(/\s{0,}<li\s{0,1}.*?>([\s\S]*?)\n{0,}\s{0,}<\/li>/gim,"[*]$1");a=a.replace(/&nbsp;/gi," ");a=a.replace(/(<[^>]+>)/gm,"");return a},_convertFontStyleToStandTag:function(){var e=this,g=e._getDesignViewDocument(),f=a(g.body),b,c,d=a("[style*='color: ']",f);if(d.length!==0){b=d;c="<font color='"+e._getWebColorFromRgb(d.css("color"))+"'></font>"}b&&a.each(b,function(){if(a(this).is("span"))a(this).replaceWith(a(c).html(a(this).html()));else a(this).is("font")&&a(this).attr("size")&&a(this).removeAttr("style").html(a(c).html(a(this).html()))})},_convertStyleToStandTag:function(){var j=this,k=j._getDesignViewDocument(),d=a(k.body),b,c,e,i=a("[style*='font-weight: bold;']",d),g=a("[style*='font-style: italic;']",d),h=a("[style*='text-decoration: line-through;']",d),f=a("[style*='text-decoration: underline;']",d);if(i.length!==0){b=i;c="<b></b>";e="font-weight"}else if(g.length!==0){b=g;c="<i></i>";e="font-style"}else if(h.length!==0){b=h;c="<strike></strikes>";e="text-decoration"}else if(f.length!==0){b=f;c="<u></u>";e="text-decoration"}b&&a.each(b,function(){if(a(this).is("span")&&this.style.fontSize==="")a(this).replaceWith(a(c).html(a(this).html()));else a(this).removeAttr("style").html(a(c).html(a(this).html()))})},_getWebColorFromRgb:function(a){var c=this,b;if(a.indexOf("rgb(")===0){b=a.substring(4,a.length-1).split(",");a=c._convertToWebColor(f(b[0]),f(b[1]),f(b[2]))}return a},_updateList:function(d,c){var b;a("option",c).remove();for(b in d)d[b]&&c.append("<option>"+b+"</option>")},_triggerEvent:function(c,d){var b=this,a=b.options[c];return a&&typeof a==="function"?a.call(b,d):a},_closeDialog:function(){this.dialog.wijdialog("close")},_onTemplateList:function(a){return this._triggerEvent("templateList",a)},updateTemplateList:function(c,e){var b=this,d=e||a("select",b.dialog);b._updateList(c,d);b._templateList=c},initTemplateDialog:function(){var b=this,d=b.dialog,e=a("select",d),c=b._onTemplateList();d.delegate("select","change."+b.widgetName,function(){b.templateListOnChanged()}).delegate("."+cd,"click."+b.widgetName,function(){b.deleteTemplate()}).delegate("."+kd,"click."+b.widgetName,function(){b.saveTemplate()}).delegate(i,"click."+b.widgetName,function(){b.applyTemplate()}).delegate(l,"click."+b.widgetName,function(){b._closeDialog()});if(!c){c=b._templateList;if(!c)return}b.updateTemplateList(c,e)},templateListOnChanged:function(){var g=this,c=g.dialog,d=a("select",c).val(),e=a("iframe",c),f=g._templateList,b;if(!f)return;b=f[d];b.src&&e.attr("src",b.src+"?d="+(new Date).getMilliseconds().toString());b.text&&e.length>0&&e[0].contentWindow.document.write(b.text);if(d){a("."+Nb,c).html(d);a("."+L,c).val(d)}if(b.desc){a("."+Rb,c).html(b.desc);a("."+T,c).val(b.desc)}},_onSaveTemplate:function(a){this._triggerEvent("saveTemplate",a)},saveTemplate:function(){var c=this,f=c.dialog,b=a("."+L,f).val(),g=a("."+T,f).val(),e=c._templateList,h=this._getDesignViewText();if(a.trim(b)===""){d("Please input a template name!");return}if(!e){c._templateList=[];e=c._templateList}!e[b]&&a("select",f).append("<option>"+b+"</option>");e[b]={desc:g,text:h};c._onSaveTemplate({name:b,desc:g,text:h})},_onDeleteTemplate:function(a){this._triggerEvent("deleteTemplate",a)},deleteTemplate:function(){var e=this,b=e.dialog,f=a("select",b),c=f.val(),g=e._templateList;if(a.trim(c)===""){d("Please select a template file.");return}a("option:selected",f).remove();a("iframe",b).attr("src","about:blank");a("."+Nb,b).empty();a("."+L,b).val("");a("."+Rb,b).empty();a("."+T,b).val("");delete g[c];e._onDeleteTemplate(c)},applyTemplate:function(){var b=this,c=b.dialog,g=a("select",c),e=g.val(),f=a("iframe",c)[0],i=a("."+L,c).val(),h=f.contentWindow.document.body.innerHTML;if(a.trim(i)===""||a.trim(e)===""){d("Please select a valid template file.");return}b._setDesignViewText(h);b._addtoUndoBuffer();b._setSaveBtnEnabled();b._closeDialog()},_onImageList:function(){var b=this,a=b.options.imageList;return a&&typeof a==="function"?a.call(b):a},updateImageList:function(b,g){var c=this,e=c.dialog,f=g||a("select",e),d=a("."+Kb,e);c._updateList(b,f);c._imgList=b;if(!b){d.addClass(ub);return}d.removeClass(ub)},initImageBrowserDialog:function(){var b=this,d=b.dialog,c=b._onImageList();a("img",d).hide();d.delegate("select","change."+b.widgetName,function(){b.imageListOnChanged(this)}).delegate("."+Y+" input","change."+b.widgetName,function(){b.imageUrlChanged(this)}).delegate(i,"click."+b.widgetName,function(){b.submitInsertImageDialog();b._onDesignViewBlur()}).delegate(l,"click."+b.widgetName,function(){b._closeDialog()});if(!c){c=b._imgList;if(!c){a("."+Kb,d).addClass(ub);return}}b.updateImageList(c,a("select",d))},imageUrlChanged:function(b){a("img",this.dialog).attr("src",a(b).val()).show()},imageListOnChanged:function(){var e=this,b=e.dialog,f=a("select",b).val(),d=e._imgList,c;if(!d)return;c=d[f];a("img",b).attr("src",c).show();a("."+Y+" input",b).attr("value",c);n.setTimeout(function(){a("."+Lb+" input",b).val(a("img",b).width());a("."+Db+" input",b).val(a("img",b).height())},200)},submitInsertImageDialog:function(){var b=this,e,c=b.dialog,g=a("."+Y+" input",c).val(),i=a("."+ad+" input",c).val(),h=a("."+Lb+" input",c).val(),f=a("."+Db+" input",c).val(),j=a("."+bd+" input",c).val();if(a.trim(g)===""){d("Please select a image.");return}if(!b._isNumeric(h)){d("Please input a number for 'Image width' textbox.");return}if(!b._isNumeric(f)){d("Please input a number for 'Image height' textbox.");return}b.focus();e='<img src="'+g+'" alt="'+i+'" width="'+h+'" height="'+f;if(b.options.mode!=="bbcode")e+='" style="'+j;e+='"/>';b.insertHTML(e);b._closeDialog()},initHyperLinkDialog:function(){var b=this,c=b.dialog,d=b.getLinkHrefField(),e=a("."+K+" input",c);c.delegate(i,"click."+b.widgetName,function(){b.submitHyperLinkDialog();b._onDesignViewBlur()}).delegate(l,"click."+b.widgetName,function(){b._closeDialog()}).delegate("."+Ab,"change."+b.widgetName,function(){b.anchorListOnChanged(this)}).delegate("."+Dc+">div","click."+b.widgetName,function(){b.radioListOnChanged()});try{e.val(d);a("."+Mb+" input",c).val(b._getLinkInnerHTML());a("."+Qb+" input",c).val(b._getLinkCssField());a("."+Q+" select",c).val(b._getLinkTarget())}catch(f){}if(d.length>4&&d.substring(0,4)==="http")a("#radUrl",c).attr("checked","checked");else if(d.length>6&&d.substring(0,6)==="mailto")a("#radMail",c).attr("checked","checked");else a("#radAnchor",c).attr("checked","checked")},_getLinkInnerHTML:function(){var b=this,a;b.focus();a=b._getInspectElement();return a&&a.tagName==="A"?a.innerHTML||"":b.getSelectionHTMLContent()||""},getLinkHrefField:function(){var b=this,a;b.focus();a=b._getInspectElement();return a&&a.tagName==="A"?b.fixAbsoluteUrlsIfNeeded(a.href||""):""},_getLinkTarget:function(){var b=this,a;b.focus();a=b._getInspectElement();return a&&a.tagName==="A"?a.target||"":""},_getLinkCssField:function(){var b=this,a;b.focus();a=b._getInspectElement();return a&&a.tagName==="A"?a.style.cssText||"":""},submitHyperLinkDialog:function(){var c=this,b=c.dialog,h=a("#radMail",b),g=a("."+K+" input",b),k=a("."+Mb+" input",b),l=a("."+Qb+" input",b),i=a("."+Q+" select",b),e=g.val(),f=k.val(),j=i.val(),m=l.val();if(e===""){d("Please input address!");return}if(f===""){d("Please input display text!");return}if(h.attr("checked")&&!c._isEmail(e)){d("Please input correct email!");return}c._editLink(f,e,m,j);c._closeDialog()},_editLink:function(g,f,d,e){var b=this,a,c="";b.focus();a=b._getInspectElement();if(a&&a.tagName==="A"){a.innerHTML=g;a.href=f;a.target=e;if(d!==a.style.cssText)a.style.cssText=d;b._addtoUndoBuffer();b._setSaveBtnEnabled();return}c='<a href="'+f+'" target="'+e+'"';if(d!=="")c+=' style="'+d+'"';c+=">"+g+"</a>";b._setIESelection();b.insertHTML(c)},anchorListOnChanged:function(d){var e=this,b=e.dialog,c=a(d).val();if(c!==""){a("."+K+" input",b).val(c);a("#radAnchor",b).attr("checked","checked")}},radioListOnChanged:function(){var e=this,b=e.dialog,c=a("."+Ab,b),d=a("."+K+" input",b);d.val("");if(a("#radUrl",b).is(":checked"))c.hide();else if(a("#radAnchor",b).is(":checked"))c.show();else if(a("#radMail",b).is(":checked")){c.hide();d.val("mailto:")}},_getDialogRes_Code:function(){var b=this,a=b._createDiv(z);a.add(b._createElement("div","Enter source code",{"class":Nd}));a.add(b._createElement("textarea","",{"class":Kc}));a.add(b._createSeparator());a.add(b._createOKCancelButtons());return a.render()},initInsertCodeDialog:function(){var a=this,b=a.dialog;b.delegate(i,"click."+a.widgetName,function(){a.submitCodeDialog();a._onDesignViewBlur()}).delegate(l,"click."+a.widgetName,function(){a._closeDialog()})},submitCodeDialog:function(){var c=this,e=c.dialog,d=a("."+Kc,e),b=d.val();if(b==="")return;b=b.replace(/</g,"&lt;");b=b.replace(/>/g,"&gt;");b="<pre>"+b+"</pre>";c._setIESelection();c.insertHTML(b);c._closeDialog()},initTagInspectorDialog:function(){var b=this,c=b.dialog,d=a("."+tb);c.delegate(i,"click."+b.widgetName,function(){b.submitTagInspectorDialog();b._onDesignViewBlur()}).delegate(l,"click."+b.widgetName,function(){b._closeDialog()}).delegate("#displayNoEmpty","click."+b.widgetName,function(){b.tagInspectorDialogSwitchAttList(this)});b._laySelectedElementAttributes(a("."+P,c),a("."+Bc,c));a("."+Fb+" input",c).val(b._getSelectedElementStyle());if(b._selectedElementCanHaveChildren()){d.show();a("textarea",d).val(b._getSelectedElementInnerHTML())}else d.hide()},submitTagInspectorDialog:function(){var b=this,g=b.dialog,c=b._getInspectElement(),e=a("."+P,g),d=a("."+Fb+" input").val(),f=a("."+tb+" textarea").val();try{a.each(a("input:checkbox",e),function(g,f){var b,e,d=a(f);if(d.is(":checked")){b=d.siblings("span").text();b=b.substring(0,b.length-1);e=d.siblings("input:text").val();a(c).attr(b,e)}});if(a.trim(d)!=="")c.style.cssText=d;b._selectedElementCanHaveChildren()&&a(c).html(f)}catch(h){}b._closeDialog();b._addtoUndoBuffer();b._setSaveBtnEnabled()},tagInspectorDialogSwitchAttList:function(c){var b=a("."+P,this.dialog),d=!c.checked;a.each(a("input:text",b),function(c,b){a(b).val()===""&&a(b).parent("li")[d?"show":"hide"]()})},_laySelectedElementAttributes:function(i,j){var f=this,c=f._getInspectElement(),g,d,e,b="";if(!c)return;j.html(c.tagName);g=f._getDictionaryDeclare();d=c.tagName.toLowerCase();e=g[d];switch(d){case"ul":case"u":case"textarea":case"tbody":case"tr":case"th":case"td":case"table":case"select":case"strong":case"span":case"p":case"option":case"ol":case"li":case"label":case"input":case"img":case"i":case"hr":case"form":case"font":case"em":case"div":case"code":case"button":case"body":case"b":case"a":b+="<ul class='ui-helper-reset'>";a.each(e,function(d,a){var e=c.getAttribute(a)||"";b+="<li><span class='"+h+"'>";b+=a+":</span>";b+="<input type='text' value='"+e+"'/>";b+="<input type='checkbox' id='save"+d+"'/>";b+="<label for='save"+d+"'>Save</label></li>"})}i.html(b)},_getSelectedElementStyle:function(){var a=this._getInspectElement();return a&&a.style?a.style.cssText||"":""},_getSelectedElementInnerHTML:function(){var a=this._getInspectElement();return a?a.innerHTML:""},_selectedElementCanHaveChildren:function(){return!a(this._getInspectElement()).is("input,hr,br,img")},initBackColorDialog:function(){this._initColorDialog("BackColor")},initForeColorDialog:function(){this._initColorDialog("ForeColor")},_initColorDialog:function(h){var c=this,g=c.dialog,k=c._getDesignViewDocument(),j=k.queryCommandValue(h),e,d,b;g.delegate(i,"click."+c.widgetName,function(){c.submitColorDialog(h);c._onDesignViewBlur()}).delegate(l,"click."+c.widgetName,function(){c._closeDialog()});if(j){b=j.toString();if(a.browser.msie){e=f(b);b="rgb("+(e&255)+", "+((e&65280)>>8)+", "+((e&16711680)>>16)+")"}if(b.indexOf("rgb(")===0){d=b.substring(4,b.length-1).split(",");b=c._convertToWebColor(f(d[0]),f(d[1]),f(d[2]))}else if(b.indexOf("rgba(")===0){d=b.substring(5,b.length-1).split(",");b=c._convertToWebColor(f(d[0]),f(d[1]),f(d[2]))}a("."+C+" input",g).attr("value",b)}a("."+xb,g).wijeditorcolorcanvas("."+C+" input",b)},submitColorDialog:function(c){var b=this,d=a("."+C+" input",b.dialog);b.setColor(c,d.val());b._closeDialog()},setColor:function(d,e){var b=this,f=b._getDesignViewDocument(),g=b._getDesignViewWindow(),c;b._setIESelection();if(a.browser.mozilla&&d==="BackColor"){c=g.getSelection();b.insertHTML('<span style="background-color:'+e+';">'+c+"</span>")}else{f.execCommand(d,false,e);b.options.mode==="bbcode"&&!a.browser.msie&&b._convertFontStyleToStandTag()}b._addtoUndoBuffer();b._setSaveBtnEnabled()},initInsertTableDialog:function(){var a=this,b=a.dialog;b.delegate(i,"click."+a.widgetName,function(){a.submitInsertTableDialog();a._onDesignViewBlur()}).delegate(l,"click."+a.widgetName,function(){a._closeDialog()}).delegate("."+F+" input:button","click."+a.widgetName,function(){a.showTableColorDialog(this)})},submitInsertTableDialog:function(){var a=this,b=a._getValuesFromTableDialog();if(!b)return;a._insertTable(b);a._closeDialog()},_insertTable:function(a){var e=this,b="",c,d;if(!a)return false;e._setIEFocus();b+='<table width="'+a.width+'" height="'+a.height+'" cellspacing="'+a.cspacing+'" cellpadding="'+a.cpadding+'" border="'+a.border+'" bgcolor="'+a.bgcolor+'" style="'+a.css+'">';for(c=0;c<a.rows;c++){b+="<tr>";for(d=0;d<a.cols;d++)b+="<td>Cell "+(c+1)+"-"+(d+1)+"</td>";b+="</tr>"}b+="</table>";e.insertHTML(b)},initEditTableDialog:function(){var c=this,b=c.dialog,d=c._getInspectElement(),e,f;b.delegate(i,"click."+c.widgetName,function(){c.submitEditTableDialog();c._onDesignViewBlur()}).delegate(l,"click."+c.widgetName,function(){c._closeDialog()}).delegate("."+F+" input:button","click."+c.widgetName,function(){c.showTableColorDialog(this)});if(!d)return;try{e=d.rows;if(e.length>0)f=e[0].cells.length;else f=0;e=e.length}catch(g){}a("."+Eb+" input",b).val(e);a("."+vb+" input",b).val(f);a("."+Bb+" input",b).val(d.getAttribute("width"));a("."+zb+" input",b).val(d.getAttribute("height"));a("."+yb+" input",b).val(d.getAttribute("border"));a("."+rb+" input",b).val(d.getAttribute("cellPadding"));a("."+sb+" input",b).val(d.getAttribute("cellSpacing"));a("."+F+" input",b).val(d.getAttribute("bgcolor")||"#ffffff");a("."+wb+" input",b).val(d.style.cssText)},submitEditTableDialog:function(){var j=this,c=j._getInspectElement(),d=a(c),b=j._getValuesFromTableDialog(),h=b&&f(b.rows),e=b&&f(b.cols),i,g;if(!b)return;if(c){d.attr("width",b.width);d.attr("height",b.height);d.attr("bgcolor",b.bgcolor);d.attr("border",b.border);d.attr("cellSpacing",b.cspacing);d.attr("cellPadding",b.cpadding);c.style.cssText=b.css;if(!h||isNaN(h))return;if(!e||isNaN(e))return;while(c.rows.length>h)c.deleteRow(0);while(c.rows.length<h){i=c.insertRow(0);while(i.cells.length<e){g=i.insertCell(0);g.innerHTML="&nbsp;"}}a.each(c.rows,function(b,a){while(a.cells.length>e)a.deleteCell(0);while(a.cells.length<e){g=a.insertCell(0);g.innerHTML="&nbsp;"}})}j._closeDialog()},_getValuesFromTableDialog:function(){var c=this,b=c.dialog,l=a("."+Eb+" input",b).val(),k=a("."+vb+" input",b).val(),j=a("."+Bb+" input",b).val(),i=a("."+zb+" input",b).val(),h=a("."+yb+" input",b).val(),e=a("."+rb+" input",b).val(),g=a("."+sb+" input",b).val(),n=a("."+wb+" input",b).val(),m=a("."+F+" input",b).val();if(!c._isNumeric(l)){d("Please input a number for 'Rows' textbox.");return false}if(!c._isNumeric(k)){d("Please input a number for 'Columns' textbox.");return false}if(!c._isNumeric(j)){d("Please input a number for 'Table Width ' textbox.");return false}if(!c._isNumeric(i)){d("Please input a number for 'Table Height' textbox.");return false}if(!c._isNumeric(h)){d("Please input a number for 'Border thickness' textbox.");return false}if(!c._isNumeric(e)){d("Please input a number for 'Cell Padding' textbox.");return false}if(!c._isNumeric(g)){d("Please input a number for 'Cell Spacing' textbox.");return false}return{rows:l,cols:k,width:f(j),height:f(i),border:h,cpadding:e,cspacing:g,css:n,bgcolor:m}},showTableColorDialog:function(f){var b=this,c=b.subDialog,d=a(f).prev().val(),e=b._getDialogRes_Color();c.empty().append(e).wijdialog({width:"auto",height:"auto",modal:true,title:"Set Background Color",position:"center",resizable:false,captionButtons:{pin:{visible:false},refresh:{visible:false},toggle:{visible:false},minimize:{visible:false},maximize:{visible:false}}});c.delegate(i,"click."+b.widgetName,function(){b.submitTableColorDialog()}).delegate(l,"click."+b.widgetName,function(){b.closeSubDialog()});d!==""&&a("."+C+" input",c).val(d);a("."+xb,c).wijeditorcolorcanvas("."+C+" input",d);c.wijdialog("open")},submitTableColorDialog:function(){var b=this,c=b.subDialog,e=b.dialog,d=a("."+C+" input",c).val();a("."+F+" input:text",e).val(d);b.closeSubDialog()},closeSubDialog:function(){this.subDialog.wijdialog("close")},_getEditableTable:function(){var e=this,b,c;b=e._getSelectedElement();if(!b){d("Please select a table!");return false}c=a(b);if(c.is("td,tr,tbody"))b=c.parents("table:first")[0];else{d("Please select a table!");return false}Xb=b;return true},initPreviewDialog:function(){var a=this,b=a.dialog;a._setPreviewContent(0);b.delegate("#rad640_480","click."+a.widgetName,function(){a._setPreviewDialogSize(640,480)}).delegate("#rad800_600","click."+a.widgetName,function(){a._setPreviewDialogSize(800,600)}).delegate("#rad1024_768","click."+a.widgetName,function(){a._setPreviewDialogSize(1024,768)}).delegate("#chkSplit","click."+a.widgetName,function(){a._splitPreviewPages(this.checked)}).delegate("."+xc,"click."+a.widgetName,function(){a._printPreviewPage(true)}).delegate("."+yc,"click."+a.widgetName,function(){a._printPreviewPage(false)}).delegate("."+Pc,"click."+a.widgetName,function(){a._closeDialog()}).delegate("."+Jc,"click."+a.widgetName,function(){a._navigatePreviewPage(false)}).delegate("."+Ic,"click."+a.widgetName,function(){a._navigatePreviewPage(true)})},_setPreviewContent:function(d){var b=this,f=b.dialog,g=a("iframe",f),e=a("."+pb+" span",f),c=g[0].contentWindow.document;c.open();if(d===-1){c.write(b._getPreviewAllPageContent());e.html("1 / 1")}else{c.write(b._getPreviewPageContent(d));e.html(d+1+" / "+b._getPreviewPageCount())}c.close()},_setPreviewDialogSize:function(g,f){var h=this,b=h.dialog,c=a("iframe",b),e=b.wijdialog("option","width"),d=b.wijdialog("option","height");if(e==="auto")e=b.parent(".wijmo-wijdialog").width()-c.width();else e=e-c.width();if(d==="auto")d=b.parent(".wijmo-wijdialog").height()-c.height();else d=d-c.height();c.css("width",g).css("height",f);b.wijdialog("option",{width:g+e,height:f+d})},_getPreviewPageCount:function(){return this._getPreviewPages().length},_getPreviewPageContent:function(a){var b=this._getPreviewPages();return b.length>a?b[a]:null},_getPreviewAllPageContent:function(){return this._getDesignViewText()},_getPreviewPages:function(){var b=this._getPreviewAllPageContent(),c=new RegExp("<(DIV|div)[^>]*(page-break-before|PAGE-BREAK-BEFORE)[ ]*:[ ]*always[^>]*>(.*?)<\\/(DIV|div)>","g"),a=b.replace(c,"!-~U^n#i@q,P|.a=g~e+br!");return a.split("!-~U^n#i@q,P|.a=g~e+br!")},_curPageIdx:0,_splitPreviewPages:function(f){var b=this,e=b.dialog,c=a("."+uc,e),d=a("."+pb,e);if(f){b._setPreviewContent(0);d.show();c.hide()}else{b._setPreviewContent(-1);d.hide();c.show()}b._curPageIdx=0},_navigatePreviewPage:function(f){var c=this,e=a("#chkSplit",c.dialog),b=c._curPageIdx,d=c._getPreviewPageCount();if(e.is(":checked")){if(f){b++;if(b<d)c._setPreviewContent(b);else b=d-1}else{b--;if(b>=0)c._setPreviewContent(b);else b=0}c._curPageIdx=b}},_printPreviewPage:function(f){var c=this,b=c.dialog,e=a("#chkSplit",b),d=a("iframe",b)[0].contentWindow;if(f){e.removeAttr("checked");c._setPreviewContent(-1)}d.focus();d.print()},initCleanUpDialog:function(){var b=this,c=b.dialog;a("textarea",c).val(b.sourceView.val());c.delegate(i,"click."+b.widgetName,function(){b.submitCleanUpDialog();b._onDesignViewBlur()}).delegate(l,"click."+b.widgetName,function(){b._closeDialog()})},submitCleanUpDialog:function(){var e=this,d=e.dialog,f=e.sourceView,b=f.val(),c;if(a("#replaceSpans",d).is(":checked")){c=new RegExp("<\\/?SPAN[^>]*>","g");b=b.replace(c,"")}if(a("#replaceClass",d).is(":checked")){c=new RegExp("<(\\w[^>]*) class=([^ |>]*)([^>]*)","g");b=b.replace(c,"<$1$3")}if(a("#replaceStyle",d).is(":checked")){c=new RegExp('<(\\w[^>]*) style="([^"]*)"([^>]*)',"g");b=b.replace(c,"<$1$3");c=new RegExp("<(\\w[^>]*) lang=([^ |>]*)([^>]*)","g");b=b.replace(c,"<$1$3");c=new RegExp("<\\\\?\\?xml[^>]*>","g");b=b.replace(c,"");c=new RegExp("<\\/?\\w+:[^>]*>","g");b=b.replace(c,"")}if(a("#replaceNbsp",d).is(":checked")){c=new RegExp("&nbsp;","g");b=b.replace(c," ")}if(a("#transformPtoDiv",d).is(":checked")){c=new RegExp("(<P)([^>]*>.*?)(<\\/P>)","g");b=b.replace(c,"<div$2</div>")}f.val(b);e._setDesignViewText(b);e._addtoUndoBuffer();e._closeDialog()},initFindDialog:function(){var a=this,b=a.dialog;b.delegate(i,"click."+a.widgetName,function(){a.submitFindAction()}).delegate(l,"click."+a.widgetName,function(){a.submitReplaceAction();a._onDesignViewBlur()})},submitFindAction:function(){var b=this,c=a("textarea:first",b.dialog).val();if(a.trim(c)==="")return;b._findAndReplaceString(c)},submitReplaceAction:function(){var f=this,e=f.dialog,b=a("textarea:first",e).val(),c=a("textarea:last",e).val();if(a.trim(b)==="")return;if(a.trim(c)===""){d("please input replace string");return}f._findAndReplaceString(b,c)},tRange:null,txtFoundInIE:false,txtFoundInNoneIE:false,_findAndReplaceString:function(e,f){var b=this,h=b._getDesignViewWindow(),c=0,g=false,i=f&&f!==e;if(!f)f=e;if(a.browser.msie){if(b.tRange)if(b.txtFoundInIE&&i){b.tRange.pasteHTML(f);b.tRange=null;g=true;b.txtFoundInIE=false}else{b.tRange.collapse(false);c=b.tRange.findText(e);c&&b.tRange.select()}if(!g&&(!b.tRange||!c)){b.tRange=h.document.body.createTextRange();c=b.tRange.findText(e);if(c){b.tRange.select();if(i){b.tRange.pasteHTML(f);b.tRange=null;g=true}}}}else{if(b.txtFoundInNoneIE&&i){b._replaceSelectionForNoneIE(f);g=true;b.txtFoundInNoneIE=false}else{c=h.find(e);if(!c){c=h.find(e,0,1);while(h.find(e,0,1))continue}}b.txtFoundInNoneIE=b.txtFoundInNoneIE||c;if(b.txtFoundInNoneIE&&i){b._replaceSelectionForNoneIE(f);g=true;b.txtFoundInNoneIE=false}}if(!c&&!g){d('"'+e+'" String Not Found');b.tRange=null;b.txtFoundInNoneIE=false;b.txtFoundInIE=false}else b.txtFoundInIE=true},_replaceSelectionForNoneIE:function(d){var a=this._getDesignViewDocument(),b="insert_html_"+Math.round(Math.random()*1e8),c=new RegExp("<[^<]*"+b+"[^>]*>");a.execCommand("insertimage",false,b);a.body.innerHTML=a.body.innerHTML.replace(c,d)},initMediaDialog:function(){var a=this,b=a.dialog;b.delegate(i,"click."+a.widgetName,function(){a.submitMediaDialog();a._onDesignViewBlur()}).delegate(l,"click."+a.widgetName,function(){a._closeDialog()})},submitMediaDialog:function(){var b=this,c=b.dialog,h=a("select",c).val(),e=a("."+Sc+" input",c).val(),g=a("."+Mc+" input",c).val(),f=a("."+Hc+" input",c).val();if(e===""){d("URL is empty!");return}if(!b._isUrl(e)){d("please input correct URL!");return}if(!b._isNumeric(g)){d("please input width of the media!");return}if(!b._isNumeric(f)){d("please input height of the media!");return}b._insertMedia(h,e,g,f);b._closeDialog()},_insertMedia:function(f,d,c,b){var e=this,a="";e._setIESelection();switch(f){case"video":a+='<embed src="'+d+'" width="'+c+'" height="'+b+'" type=audio/x-pn-realaudio-plugin console="Clip1" controls="IMAGEWINDOW,ControlPanel,StatusBar" autostart="true"></embed>';break;case"flash":a+='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,29,0" width="'+c+'" height="'+b+'">';a+='<param name="movie" value="'+d+'">';a+='<param name="quality" value="high">';a+='<embed src="'+d+'" quality="high" pluginspage="http://www.macromedia.com/go/getflashplayer" type="application/x-shockwave-flash" width="'+c+'" height="'+b+'"></embed>';a+="</object>";break;case"applet":a+='<applet code="'+d+'" width="'+c+'" height="'+b+'"></applet>';break;case"other":a+='<embed src="'+d+'" width="'+c+'" height="'+b+'"></embed>'}e.insertHTML(a)},initSpecialCharacterDialog:function(){var b=this,d=b.dialog,c=a("."+vc+" span",d);d.delegate("label","click."+b.widgetName,function(){b.submitSpecialCharacterDialog(this);b._onDesignViewBlur()}).delegate(i,"click."+b.widgetName,function(){b._closeDialog()}).delegate("label","mouseover."+b.widgetName,function(){c.html(a(this).html())}).delegate("label","mouseout."+b.widgetName,function(){c.empty()})},submitSpecialCharacterDialog:function(c){var b=this;b._setIESelection();b.insertHTML(a(c).html());b._closeDialog()},_setSaveBtnEnabled:function(){c.wijribbon(D,qc,false)},_undoAction:function(){var b=this._getDesignViewDocument().body,a={};k--;if(k<=0)k=0;b.innerHTML=A[k];if(!k){a[E]=true;a[H]=false;c.wijribbon(Cb,a)}else c.wijribbon(D,H,false)},_redoAction:function(){var d=this._getDesignViewDocument().body,b=A.length,a={};k++;if(k>=b-1)k=b-1;d.innerHTML=A[k];if(k===b-1){a[E]=false;a[H]=true;c.wijribbon(Cb,a)}else c.wijribbon(D,E,false)},_addtoUndoBuffer:function(){for(var b=A.length-1-k,a=0;a<b;a++)A.pop();k++;A.push(this._getDesignViewText());c.wijribbon(D,E,false)},_deleteSelectionContent:function(){var e=this._getDesignViewWindow(),b,c,d,f="rangeCount";if(a.browser.msie){b=e.document.selection;b.type.toLowerCase()!=="none"&&b.clear()}else{b=e.getSelection();for(c=0;c<b[f];c++){d=b.getRangeAt(c);d.deleteContents()}}},_refreshPathSelector:function(){var e=this,d=e._getParentElement(e._getDesignViewWindow()),c=e._getPathSelector(),f=a(d).parents(),h=f.length,g="wijmo-wijeditor-label ui-state-default ui-corner-all",b;if(!d)return;c.empty();for(b=h-1;b>=0;b--)c.append("<label class='"+g+"'>&lt;"+f[b].tagName.toLowerCase()+"&gt;</label>");c.append("<label class='"+g+" wijmo-wijeditor-selectlabel ui-state-highlight ui-corner-all'>&lt;"+d.tagName.toLowerCase()+"&gt;</label>")},_toggleTableBorders:function(){var c=this._getDesignViewDocument(),b=a("#__wijStyle",c);U=!U;if(a.browser.safari)if(U)b.html("table,td,tr{border: 1px #acacac dashed;}");else b.empty();else b.attr("disabled",!U)},_tableAction:function(j){var b=this,o=b._getParentElement(b._getDesignViewWindow()),k=a(o).closest("td"),l,n,q,f,c,h,g,i,m,p,e=0;b._setSaveBtnEnabled();if(k.length===0&&j!==M)return false;else if(j!==M){l=k.parent();n=l.closest("table");q=k[0];f=l[0];c=n[0];h=f.rowIndex;g=q.cellIndex}try{switch(j){case ac:i=f.cells.length;p=c.insertRow(h);for(e=0;e<i;e++)b._insertCell(p,e);break;case bc:c.deleteRow(h);break;case Hb:m=c.rows.length;for(e=0;e<m;e++)b._insertCell(c.rows[e],g);break;case Ib:b._removeColumn(c,g);break;case Tb:b._insertCell(f,g+1);break;case Vb:i=f.cells.length;if(i===1)c.deleteRow(h);else f.deleteCell(g);break;case cc:b._splitCell(c,f,h,g);break;case M:b._mergeCell(b._getSelectedCells(o))}this._addtoUndoBuffer()}catch(r){d(r.message);return false}return true},_removeColumn:function(e,h){var i=e.rows.length,f=0,g,c,a,b,d;while(f<i){g=e.rows[f];c=g.cells;a=c.length;b=h>a-1?a-1:h;d=c[b].colSpan;if(d>1&&a>1)if(b+1<a)c[b+1].colSpan+=d-1;else c[b-1].colSpan+=d+1;if(a===1){e.deleteRow(f);i=e.rows.length}else{g.deleteCell(b);f++}}},_splitCell:function(j,h,l,e){var k=j.rows.length,a=0,i=0,f,d,b,g,c;while(a<=e){if(h.cells[a].colSpan>1)i+=h.cells[a].colSpan-1;a++}this._insertCell(h,e+1);for(b=0;b<k;b++){f=j.rows[b];if(b!==l){g=e;a=0;d=0;while(a<=g){if(f.cells[a].colSpan>1){d+=f.cells[a].colSpan-1;g-=d}a++}c=e+i-d;if(c<0)c=0;f.cells[c].colSpan++}}},_mergeCell:function(b){var e=b.length,c,a,f,d;if(e<2||b[0].parentNode!==b[e-1].parentNode)return false;c=b[0].parentNode;a=b[0].cellIndex;f=a+e;for(d=a+1;d<f;d++){c.cells[a].innerHTML+=c.cells[a+1].innerHTML;c.cells[a].colSpan++;c.deleteCell(a+1)}},_getSelectedCells:function(k){var j=this._getDesignViewWindow(),m=j.document,e=[],b,d,h,c,f,g,i,l;if(a.browser.msie){b=m.selection.createRange();d=a(k).closest("tr")[0];d&&a.each(d.cells,function(f,d){var a=m.selection.createRange(),c="compareEndPoints";a.moveToElementText(d);(b.inRange(a)||b[c]("StartToStart",a)>=0&&b[c]("StartToEnd",a)<=0||b[c]("EndToStart",a)>=0&&b[c]("EndToEnd",a)<=0)&&e.push(d)})}else if(a.browser.mozilla){h=j.getSelection();f=h.rangeCount;for(c=0;c<f;c++){b=h.getRangeAt(c);g=b.startContainer;i=g.nodeName.toLowerCase();if(i==="td"||i==="th")e.push(g);else if(i==="tr"){l=b.startOffset;e.push(g.cells[l])}}}else{h=j.getSelection();d=a(k).closest("tr")[0];f=d.cells.length;if(d)for(c=0;c<f;c++)e.push(d.cells[c])}return e},insertDateAndTime:function(){this.insertHTML((new Date).toDateString()+" "+(new Date).toTimeString())},_toggleWordWrap:function(){var d=this,b=d.sourceView,e="wrap",c;rc=!rc;c=rc?"soft":"off";b.attr(e,c);b[0].focus();if(a.browser.mozilla){b.hide();n.setTimeout(function(){b.show()},40)}},insertHTML:function(d){var c=this,e=c._getDesignViewDocument(),b;try{if(a.browser.msie){b=e.selection.createRange();b.pasteHTML(d);b.collapse(false);b.select()}else e.execCommand("insertHTML",false,d)}catch(f){}c._addtoUndoBuffer();c._setSaveBtnEnabled()},_getSelectedContent:function(){var g=this._getDesignViewWindow(),f=g.document,c="",d="cloneContents",a,e,b;if(!f.selection){a=g.getSelection().getRangeAt(0);if(a)if(a[d]){e=a[d]();b=document.createElement("div");b.appendChild(e);c=b.innerHTML;b=null}}else{a=f.selection.createRange();return a.htmlText}return c||""},_setIESelection:function(){a.browser.msie&&j&&j.select()},_setIEFocus:function(){var b=this._getDesignViewDocument();if(a.browser.msie)try{b.body.focus()}catch(c){}},focus:function(){var b=this._getDesignViewWindow(),c=b.document;if(a.browser.msie)if(!j)c.body.focus();else j.select();else b.focus()},_getInspectElement:function(){return Xb||this._getSelectedElement()},_getSelectedElement:function(){return this._getParentElement(this._getDesignViewWindow())},_createElement:function(c,a,b){return new fb(c,a,b)},_createDiv:function(a){return this._createElement("div",{"class":a})},_createSpan:function(a,b){var c=this;return!b?c._createElement("span",{"class":a}):a.length===0?c._createElement("span",b):this._createElement("span",b,{"class":a})},_createTextBox:function(c,b){var a={"class":c,type:"text"};if(b)a.value=b;return this._createElement("input",a)},_createLabel:function(b,a){return a?new fb("label",b,{"for":a}):new fb("label",b)},_createRadio:function(d,c,b){var a={name:c,id:d,value:b,type:"radio"};return this._createElement("input",a)},_createCheckbox:function(b){var a={type:"checkbox",id:b};return this._createElement("input","",a)},_createSelect:function(d,e){var c=this,f={"class":d},b=c._createElement("select",f);if(d==="")b=c._createElement("select");a.each(e,function(e,d){if(a.isPlainObject(d)&&d.selected)b.add(c._createElement("option",d.text,{selected:"selected"}));else b.add(c._createElement("option",d))});return b},_createInputButton:function(c,b){var a={"class":c,type:"button"};if(b)a.value=b;return this._createElement("input",a)},_createTextField:function(g,f,e,c){var b=this,a=b._createDiv(f),d={type:"text"};if(c)d.value=c;a.add(b._createSpan(h,g));a.add(b._createElement("input",d));e&&a.add(new Df(e));return a},_createSeparator:function(){var b=this,a=b._createDiv(Ef);a.add(b._createElement("hr"));return a},_createOKCancelButtons:function(){var b=this,a=b._createDiv(G);a.add(b._createElement("input",{type:"button","class":o,value:"OK"}));a.add(b._createElement("input",{type:"button","class":o,value:"Cancel"}));return a},_getDialogRes_Template:function(){var a=this,b=a._createDiv(g),e=a._createDiv(Bf),f=a._createDiv(rf),m=a._createDiv(Cf),l=a._createDiv(sf),i=a._createDiv(uf),j=a._createElement("div","Name :"),k=a._createElement("div","Description :"),c=a._createDiv(Af),d=a._createDiv(qf);e.add(a._createElement("div","Select Template:",{"class":tf}));e.add(a._createElement("div","Template Preview:",{"class":vf}));b.add(e);m.add(a._createElement("select",{size:8}));l.add(a._createElement("iframe",{frameborder:0}));f.add(m);f.add(l);b.add(f);j.add(a._createSpan(Nb));k.add(a._createSpan(Rb));i.add(j);i.add(k);b.add(i);c.add(a._createSpan(h,"Name :"));c.add(a._createTextBox(L));c.add(a._createSpan(h,"Description :"));c.add(a._createTextBox(T));b.add(c);d.add(a._createInputButton(o+" "+cd,"Delete selected"));d.add(a._createInputButton(o+" "+kd,"Save current page as template"));b.add(d);b.add(a._createSeparator());b.add(a._createOKCancelButtons());return b.render()},_getDialogRes_ImageBrowser:function(){var a=this,g=a._createDiv(m),c=a._createDiv(Ie),b=a._createDiv(Se),d=a._createDiv(Kb),f=a._createDiv(ff),e=a._createDiv(Je);b.add(a._createTextField("Image src:",Y));b.add(a._createTextField("Image alt text:",ad));b.add(a._createTextField("Image width:",Lb,"px"));b.add(a._createTextField("Image height:",Db,"px"));b.add(a._createTextField("Css text:",bd));c.add(b);d.add(f);f.add(a._createElement("select",{size:8}));d.add(e);e.add(a._createElement("img",{src:"",alt:""}));c.add(d);c.add(a._createSeparator());c.add(a._createOKCancelButtons());g.add(c);return g.render()},_getDialogRes_Link:function(){var b=this,c=b._createDiv(z),n=b._createTextField("Address :",K),f=b._createDiv(Dc),e=b._createElement("div"),m=[{id:"radUrl",value:"url"},{id:"radAnchor",value:"anchor",checked:true},{id:"radMail",value:"email"}],i=[],o=b._createTextField("Text to display :",Mb),g=b._createDiv(Q),l=b._createSpan(h,"Target :"),j=[{text:"_blank",selected:true},"_parent","_self","_top"],k=b._createSelect(Q,j),p=b._createTextField("Css :",Qb),d;c.add(n);c.add(f);f.add(e);a.each(m,function(c,a){e.add(b._createRadio(a.id,"radioList",a.value));e.add(b._createLabel(a.value,a.id))});for(d=1;d<8;d++)i.push("#anchor"+d.toString());f.add(b._createSelect(Ab,i));c.add(b._createSeparator());c.add(o);c.add(g);g.add(l);g.add(k);c.add(p);c.add(b._createSeparator());c.add(b._createOKCancelButtons());return c.render()},_getDialogRes_TagInspector:function(){var a=this,b=a._createDiv(s),f=a._createDiv(ne),c=a._createDiv(Hd),e=a._createDiv(me),d=a._createDiv(tb);b.add(f);f.add(a._createSpan(ee,"Selected tag:"));f.add(a._createSpan(Bc,""));b.add(c);c.add(a._createCheckbox("displayNoEmpty"));c.add(a._createLabel("Display not empty attributes only","displayNoEmpty"));b.add(e);e.add(a._createSpan(h,"Attributes:"));e.add(a._createDiv(P));b.add(d);d.add(a._createSpan(h,"Inner HTML:"));d.add(a._createElement("textarea"));b.add(a._createTextField("Css Text:",Fb));b.add(a._createSeparator());b.add(a._createOKCancelButtons());return b.render()},_getDialogRes_Color:function(){return this._getDialogRes_CommonColor("#FFFFFF")},_getDialogRes_ForeColor:function(){return this._getDialogRes_CommonColor("#000000")},_getDialogRes_BackColor:function(){return this._getDialogRes_CommonColor("#FFFFFF")},_getDialogRes_CommonColor:function(d){var a=this,b=a._createDiv(gc),c=a._createDiv(C);b.add(a._createDiv(xb));b.add(c);c.add(a._createSpan(h,"Selected Color:"));c.add(a._createElement("input",{type:"text",value:d}));b.add(a._createSeparator());b.add(a._createOKCancelButtons());return b.render()},_getDialogRes_Table:function(){var a=this,b=a._createDiv(q),c=a._createDiv(F);b.add(a._createTextField("Rows :",Eb,"",3));b.add(a._createTextField("Columns :",vb,"",3));b.add(a._createTextField("Table Width :",Bb,"&nbsp;pixels",200));b.add(a._createTextField("Table Height :",zb,"&nbsp;pixels",200));b.add(a._createTextField("Border thickness :",yb));b.add(a._createTextField("Cell Padding :",rb));b.add(a._createTextField("Cell Spacing :",sb));b.add(a._createTextField("Css Text :",wb));b.add(c);c.add(a._createSpan(h,"Background Color :"));c.add(a._createElement("input",{type:"text"}));c.add(a._createElement("input",{type:"button",value:"..."}));b.add(a._createSeparator());b.add(a._createOKCancelButtons());return b.render()},_getDialogRes_Preview:function(){var a=this,c=a._createDiv(p),b=a._createDiv(Vd),e=a._createDiv(G),d=a._createDiv(pb),f=a._createDiv(Dd);c.add(b);b.add(a._createSpan(h,"Preview Size:"));b.add(a._createElement("input",{id:"rad640_480",name:"preview",type:"radio",checked:"checked"}));b.add(a._createLabel("640x480","rad640_480"));b.add(a._createElement("input",{id:"rad800_600",name:"preview",type:"radio"}));b.add(a._createLabel("800x600","rad800_600"));b.add(a._createElement("input",{id:"rad1024_768",name:"preview",type:"radio"}));b.add(a._createLabel("1024x768","rad1024_768"));b.add(a._createElement("input",{id:"chkSplit",type:"checkbox",checked:"checked"}));b.add(a._createLabel("Split pages","chkSplit"));c.add(a._createSeparator());c.add(e);e.add(a._createInputButton(o+" "+xc,"Print All"));e.add(a._createInputButton(o+" "+yc,"Print Page"));e.add(a._createInputButton(o+" "+Pc,"OK"));c.add(a._createSeparator());c.add(d);d.add(a._createElement("a","Prev page",{"class":Jc,href:"#"}));d.add(a._createElement("span","1 / 1"));d.add(a._createElement("a","Next page",{"class":Ic,href:"#"}));c.add(a._createDiv(uc));c.add(f);f.add(a._createElement("iframe",{src:"about:blank"}));return c.render()},_getDialogRes_CleanUp:function(){var b=this,c=b._createDiv(X),e=b._createDiv(Ud),f=b._createDiv(Md),d=b._createDiv(Td),g=[{id:"replaceSpans",label:"Strip SPAN tag"},{id:"replaceClass",label:"Strip CLASS tag"},{id:"replaceStyle",label:"Strip STYLE attribute"},{id:"replaceNbsp",label:"Replace &amp;nbsp; symbol"},{id:"transformPtoDiv",label:"Transform Paragraph to DIV"}];c.add(e);e.add(b._createSpan(h,"Document source :"));c.add(f);f.add(b._createElement("textarea",{readonly:"readonly"}));c.add(d);a.each(g,function(c,a){d.add(b._createCheckbox(a.id));d.add(b._createLabel(a.label,a.id))});c.add(b._createSeparator());c.add(b._createOKCancelButtons());return c.render()},_getDialogRes_FindAndReplace:function(){var a=this,b=a._createDiv(jc),e=a._createDiv(af),d=a._createDiv(Ae),c=a._createDiv(G);b.add(e);e.add(a._createSpan(h,"Find:"));e.add(a._createElement("textarea","text"));b.add(d);d.add(a._createSpan(h,"Replace:"));d.add(a._createElement("textarea"));b.add(a._createSeparator());b.add(c);c.add(a._createInputButton(o,"Find"));c.add(a._createInputButton(o,"Replace"));return b.render()},_getDialogRes_Media:function(){var a=this,b=a._createDiv(O),c=a._createDiv(Te);b.add(c);c.add(a._createSpan(h,"Media Type :"));c.add(a._createSelect("",["flash","video","applet","other"]));b.add(a._createTextField("Media Url :",Sc));b.add(a._createTextField("Width :",Mc,"px",200));b.add(a._createTextField("Height :",Hc,"px",200));b.add(a._createSeparator());b.add(a._createOKCancelButtons());return b.render()},_getDialogRes_SpecialCharacter:function(){var b=this,c=b._createDiv(r),e=b._createDiv(Ld),m=b._createDiv(Fd),l=b._createDiv(vc),d=b._createDiv(Sd),f=b._createDiv(qb,"Punctuation"),i=b._createDiv(Bd),p=["&#8211;","&#8212;","&iexcl;","&iquest;","&quot;","&laquo;","&raquo;","&nbsp;"],h=b._createDiv(qb,"Symbols"),n=b._createDiv(Gd),s=["&amp;","&cent;","&copy;","&divide;","&gt;","&lt;","&micro;","&#8226;","&para;","&plusmn;","&#8364;","&pound;","&reg;","&sect;","&yen;"],g=b._createDiv(qb,"Diacritics"),j=b._createDiv(Cd),q=["&aacute;","&Aacute;","&agrave;","&Agrave;","&acirc;","&Acirc;","&aring;","&Aring;","&atilde;","&Atilde;","&auml;","&Auml;","&aelig;","&AElig;","&ccedil;","&Ccedil;","&eacute;","&Eacute;","&egrave;","&Egrave;","&ecirc;","&Ecirc;","&euml;","&Euml;","&iacute;","&Iacute;","&igrave;","&Igrave;","&icirc;","&Icirc;","&iuml;","&Iuml;","&ntilde;","&Ntilde;","&oacute;","&Oacute;","&ograve;","&Ograve;","&ocirc;","&Ocirc;","&oslash;","&Oslash;","&otilde;","&Otilde;","&ouml;","&Ouml;","&uacute;","&Uacute;","&ugrave;","&Ugrave;","&ucirc;","&Ucirc;","&uuml;","&Uuml;","&szlig;","&yuml;","&#8216;","&#8217;"],k=b._createDiv(G);c.add(e);e.add(m);m.add(l);l.add(new fb("span"));e.add(d);d.add(f);f.add(i);a.each(p,function(c,a){i.add(b._createLabel(a))});d.add(h);h.add(n);a.each(s,function(c,a){n.add(b._createLabel(a))});d.add(g);g.add(j);a.each(q,function(c,a){j.add(b._createLabel(a))});c.add(b._createSeparator());k.add(b._createInputButton(o,"Cancel"));c.add(k);return c.render()},_copyFromClipboard:function(){var d,c,b={},e={};if(n.clipboardData)return n.clipboardData.getData("Text");else if(a.browser.mozilla){try{netscape.security.PrivilegeManager.enablePrivilege&&netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(f){}d=Components.classes["@mozilla.org/widget/clipboard;1"].getService(Components.interfaces.nsIClipboard);if(!d)return false;c=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(!c)return false;c.addDataFlavor("text/unicode");d.getData(c,d.kGlobalClipboard);c.getTransferData("text/unicode",b,e);if(b)b=b.value.QueryInterface(Components.interfaces.nsISupportsString);return b?b.data.substring(0,e.value/2):""}},_copyToClipboard:function(e){var f,c,g,b={},h={};if(n.clipboardData&&e)n.clipboardData.setData("Text",e);else if(a.browser.mozilla)try{netscape.security.PrivilegeManager.enablePrivilege&&netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect");f=Components.classes["@mozilla.org/widget/clipboard;1"].createInstance(Components.interfaces.nsIClipboard);if(!f)return;c=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(!c)return;c.addDataFlavor("text/unicode");b={};h={};b=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString);b.data=e;c.setTransferData("text/unicode",b,e.length*2);g=Components.interfaces.nsIClipboard;if(!f)return false;f.setData(c,null,g.kGlobalClipboard)}catch(i){b="Copy text to Clipboard \n";b+="If you are using firefox please do the following :\n ";b+="1. Write in your url box : 'about:config'\n";b+="2. Change signed.applets.codebase_principal_support = true\n";d(b)}},fixAbsoluteUrlsIfNeeded:function(o){for(var g=this,n=tc.URL,b=tc.URL,f=tc.URL,i=false,p=b.length,a=o,d,j,k,c,l,m,h,e=p-1;e>0;e--){d=b.charAt(e);j=b.charAt(e-1);if(d==="/"||d==="\\"){if(d===j)break;f=b.substring(0,e)+d;if(!i){b=f;i=true}}}k=g._prepareLiteralRegexText(n+"?");c=new RegExp(k,"g");a=a.replace(c,"?");l=g._prepareLiteralRegexText(b);c=new RegExp(l,"g");a=a.replace(c,"");m=g._prepareLiteralRegexText(f);c=new RegExp(m,"g");a=a.replace(c,"/");h=a.indexOf("#");if(h>-1)a=a.substr(h);return a},_insertCell:function(c,b){var a=c.insertCell(b);a.innerHTML="&nbsp;";return a},_getDictionaryDeclare:function(){var a={};a.a=["accesskey","charset","class","coords","dir","href","hreflang","id","lang","name","rel","rev","shape","tabindex","target","title"];a.b=["class","dir","id","lang","title"];a.body=["alink","background","bgColor","bgproperties","bottommargin","class","dir","id","lang","leftmargin","link","marginheight","marginwidth","rightmargin","text","title","topmargin","vlink"];a.button=["accesskey","class","dir","disabled","id","lang","name","tabindex","title","type","value"];a.code=["class","dir","id","lang","title"];a.div=["align","class","dir","id","lang","title"];a.em=["class","dir","id","lang","title"];a.font=["class","color","dir","face","id","lang","pointsize","size","title"];a.form=["action","class","dir","enctype","id","lang","method","name","runat","target","title"];a.hr=["align","class","color","id","noshade","size","title","width"];a.i=["class","dir","id","lang","title"];a.img=["align","alt","border","class","controls","dir","dynsrc","height","hspace","id","ismap","lang","longdesc","loop","lowsrc","name","src","start","title","usemap","vspace","width"];a.input=["accept","accesskey","align","alt","border","checked","class","dir","disabled","height","hspace","id","lang","maxlength","name","readonly","size","src","tabindex","title","type","usemap","value","vspace","width"];a.label=["accesskey","class","dir","for","id","lang","title"];a.li=["class","dir","id","lang","title","type","value"];a.ol=["class","compact","dir","id","lang","start","title","type"];a.option=["class","dir","disabled","id","label","lang","selected","title","value"];a.p=["align","class","dir","id","lang","title"];a.span=["class","dir","id","lang","title"];a.strong=["class","dir","id","lang","title"];a.select=["accesskey","class","dir","disabled","id","lang","multiple","name","size","tabindex","title"];a.table=["align","background","bgColor","border","bordercolor","bordercolordark","bordercolorlight","cellpadding","cellspacing","class","cols","datapagesize","dir","frame","height","hspace","id","lang","rules","summary","title","vspace","width"];a.td=["abbr","align","axis","background","bgColor","bordercolor","bordercolordark","bordercolorlight","class","colspan","dir","headers","height","id","lang","nowrap","rowspan","scope","title","valign","width"];a.th=["abbr","align","axis","background","bgColor","bordercolor","bordercolordark","bordercolorlight","class","colspan","dir","headers","height","id","lang","nowrap","rowspan","scope","title","valign","width"];a.tr=["align","bgColor","bordercolor","bordercolordark","bordercolorlight","class","dir","height","id","lang","nowrap","title","valign"];a.tbody=["align","bgColor","class","dir","id","lang","title","valign"];a.textarea=["accesskey","class","cols","dir","disabled","id","label","lang","name","readonly","rows","tabindex","title","wrap"];a.u=["class","id","xml:lang"];a.ul=["class","compact","dir","id","lang","title","type"];return a},_getParentElement:function(e){var h=this,a=h._getRange(e),b,f,g,c,d;if(!a)return null;if(a.commonAncestorContainer){b=e.getSelection();f=a.startContainer||b.baseNode;g=a.endContainer||b.extentNode;c=a.startOffset;if(c===null)c=b.baseOffset;d=a.endOffset;if(d===null)d=b.extentOffset;return f===g&&d-c===1?b.anchorNode.childNodes[b.anchorOffset]:!a.commonAncestorContainer.tagName?e.document===a.commonAncestorContainer&&b.baseNode?b.baseNode.parentNode:a.commonAncestorContainer.parentNode:a.commonAncestorContainer}return a.length?a.item(0):a.parentElement?a.parentElement():null},_getRange:function(a){var b,c;if(a.document.selection&&!n.opera)return a.document.selection.createRange();if(a.getSelection){b=a.getSelection();if(!b||b.rangeCount<1)return null;if(b.getRangeAt)c=b.getRangeAt(0);else c=a.document.createRange();return c}},_generateUniqueName:function(b){var a=wd[b];if(!a)a=0;wd[b]=++a;return b+a},_setContentEditable:function(b,d){var c="designMode",e="contentEditable";try{if(b.body[e])b.body[e]=d.toString();if(b[c])if(!d&&b[c]!=="off")b[c]="off";else if(d&&b[c]!=="on")b[c]="on";d&&!a.browser.msie&&b.execCommand("useCSS",false,true)}catch(f){}},_formatString:function(a,d){for(var c=a.length,b=0;b<d-c;b++)a="0"+a;return a},_convertToWebColor:function(c,b,a){var d=this,i,h,g,e;if(isNaN(c)||255-c<0)c=0;if(isNaN(b)||255-b<0)b=0;if(isNaN(a)||255-a<0)a=0;i=d._formatString(f(c).toString(16),2);h=d._formatString(f(b).toString(16),2);g=d._formatString(f(a).toString(16),2);e="#"+i+h+g;return e},_prepareLiteralRegexText:function(b){var a=b;a=a.replace("\\","\\\\");a=a.replace(".","\\.");a=a.replace("?","\\?");return a},_isNumeric:function(a){return new RegExp("^\\d+$").test(a)},_isEmail:function(a){return new RegExp("mailto:(\\S)+[@]{1}(\\S)+[.]{1}(\\w)+").test(a)},_isUrl:function(a){return new RegExp("[a-zA-z]+://[^s]+").test(a)},refresh:function(){var a=this,d=a.element,g=a._getHeader(),f=a._getFooter(),i=d.width(),h=d.height(),e=a._getContent(),b;a.editor.width(i).height(h);c.wijribbon("updateRibbonSize");b=a.editor.height()-g.outerHeight(true)-f.outerHeight(true);e.height(b).wijsplitter("refresh")},getText:function(){var a=this;return a._getDesignViewText()},setText:function(a){var b=this;a&&b._setDesignViewText(a)}})})(jQuery);(function(a){"use strict";var d=document,b=parseInt,c="wijmo-wijeditor",e=c+"-colorcanvas",g=c+"-color",h=c+"-wheel",i=c+"-overlay",f=c+"-marker";a.fn.wijeditorcolorcanvas=function(c,b){a.wijeditorcolorcanvas(this,c,b);return this};a.wijeditorcolorcanvas=function(c,e,d){var b=a(c).get(0);return b.wijeditorcolorcanvas||(b.wijeditorcolorcanvas=new a._wijeditorcolorcanvas(b,e,d))};a._wijeditorcolorcanvas=function(l,n,o){var c=this,j="",k,m;m="progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true, sizingMethod=crop, ";j+="<div class='"+e+"'>";j+="<div class='"+g+"'></div>";j+="<div class='"+h+"'></div>";j+="<div class='"+i+"'></div>";j+="<div class='h-marker "+f+"'></div>";j+="<div class='sl-marker "+f+"'></div></div>";a(l).html(j);k=a("."+e,l);c.wheel=a("."+h,l).get(0);c.radius=84;c.square=100;c.width=194;a.browser.msie&&a.browser.version<7&&a("*",k).each(function(){var c=this,b=c.currentStyle.backgroundImage;if(b!=="none"){b=b.substring(5,b.length-2);a(c).css({backgroundImage:"none",filter:m+"src='"+b+"')"})}});c.linkTo=function(b){typeof c.callback==="object"&&a(c.callback).unbind("keyup",c.updateValue);c.color=null;if(typeof b==="function")c.callback=b;else if(typeof b==="object"||typeof b==="string"){c.callback=a(b);c.callback.bind("keyup",c.updateValue);c.callback.get(0).value&&c.setColor(c.callback.get(0).value)}return this};c.updateValue=function(){var a=this;a.value&&a.value!==c.color&&c.setColor(a.value)};c.setColor=function(a){var b=c.unpack(a);if(c.color!==a&&b){c.color=a;c.rgb=b;c.hsl=c.RGBToHSL(c.rgb);c.updateDisplay()}return this};c.setHSL=function(a){c.hsl=a;c.rgb=c.HSLToRGB(a);c.color=c.pack(c.rgb);c.updateDisplay();return this};c.widgetCoords=function(b){var f,g,h,e,d;h=b.target||b.srcElement;e=c.wheel;d=c.absolutePosition(e);f=(b.pageX||0*(b.clientX+a("html").get(0).scrollLeft))-d.x;g=(b.pageY||0*(b.clientY+a("html").get(0).scrollTop))-d.y;return{x:f-c.width/2,y:g-c.width/2}};c.mousedown=function(b){if(!d.dragging){a(d).bind("mousemove",c.mousemove).bind("mouseup",c.mouseup);d.dragging=true}var e=c.widgetCoords(b);c.circleDrag=Math.max(Math.abs(e.x),Math.abs(e.y))*2>c.square;c.mousemove(b);return false};c.mousemove=function(f){var b=c.widgetCoords(f),a,e,d;if(c.circleDrag){a=Math.atan2(b.x,-b.y)/6.28;if(a<0)a+=1;c.setHSL([a,c.hsl[1],c.hsl[2]])}else{e=Math.max(0,Math.min(1,-(b.x/c.square)+.5));d=Math.max(0,Math.min(1,-(b.y/c.square)+.5));c.setHSL([c.hsl[0],e,d])}return false};c.mouseup=function(){a(d).unbind("mousemove",c.mousemove).unbind("mouseup",c.mouseup);d.dragging=false};c.updateDisplay=function(){var d=c.hsl[0]*6.28,b;a(".h-marker",k).css({left:Math.round(Math.sin(d)*c.radius+c.width/2)+"px",top:Math.round(-Math.cos(d)*c.radius+c.width/2)+"px"});a(".sl-marker",k).css({left:Math.round(c.square*(.5-c.hsl[1])+c.width/2)+"px",top:Math.round(c.square*(.5-c.hsl[2])+c.width/2)+"px"});a("."+g,k).css("backgroundColor",c.pack(c.HSLToRGB([c.hsl[0],1,.5])));if(typeof c.callback==="object"){a(c.callback).css({backgroundColor:c.color,color:c.hsl[2]>.5?"#000":"#fff"});a(c.callback).each(function(){b=this;if(b.value&&b.value!==c.color)b.value=c.color})}else typeof c.callback==="function"&&c.callback.call(c,c.color)};c.absolutePosition=function(a){var d={x:a.offsetLeft,y:a.offsetTop},b;if(a.offsetParent){b=c.absolutePosition(a.offsetParent);d.x+=b.x;d.y+=b.y}return d};c.pack=function(a){var d=Math.round(a[0]*255),c,b;c=Math.round(a[1]*255);b=Math.round(a[2]*255);return"#"+(d<16?"0":"")+d.toString(16)+(c<16?"0":"")+c.toString(16)+(b<16?"0":"")+b.toString(16)};c.unpack=function(a){return a.length===7?[b("0x"+a.substring(1,3))/255,b("0x"+a.substring(3,5))/255,b("0x"+a.substring(5,7))/255]:a.length===4?[b("0x"+a.substring(1,2))/15,b("0x"+a.substring(2,3))/15,b("0x"+a.substring(3,4))/15]:void 0};c.HSLToRGB=function(g){var c,b,d,e,a,f=this;d=g[0];e=g[1];a=g[2];b=a<=.5?a*(e+1):a+e-a*e;c=a*2-b;return[f.hueToRGB(c,b,d+.33333),f.hueToRGB(c,b,d),f.hueToRGB(c,b,d-.33333)]};c.hueToRGB=function(b,c,a){a=a<0?a+1:a>1?a-1:a;return a*6<1?b+(c-b)*a*6:a*2<1?c:a*3<2?b+(c-b)*(.66666-a)*6:b};c.RGBToHSL=function(i){var h,a,f,g,j,d,e,c,b;e=i[0];c=i[1];b=i[2];h=Math.min(e,Math.min(c,b));a=Math.max(e,Math.max(c,b));f=a-h;d=(h+a)/2;j=0;if(d>0&&d<1)j=f/(d<.5?2*d:2-2*d);g=0;if(f>0){if(a===e&&a!==c)g+=(c-b)/f;if(a===c&&a!==b)g+=2+(b-e)/f;if(a===b&&a!==e)g+=4+(e-c)/f;g/=6}return[g,j,d]};a("*",k).mousedown(c.mousedown);c.setColor(o||"#000000");n&&c.linkTo(n)}})(jQuery);